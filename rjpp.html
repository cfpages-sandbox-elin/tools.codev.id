<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RJPP - Rencana Jangka Panjang Perusahaan</title>
    <style>
        body {
            font-family: sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f4f4f4;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .container {
            width: 80%;
            max-width: 800px;
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        textarea { width: 100%; height: 150px; margin-bottom: 10px; box-sizing: border-box; border-radius: 5px; border: 1px solid #ccc; padding: 8px; }
        button { padding: 10px 20px; cursor: pointer; border-radius: 5px; background-color: #f0f0f0; border: 1px solid #ccc; }
        button:hover { background-color: #e0e0e0; }
        #status { margin-top: 10px; white-space: pre-wrap; height: 150px; overflow-y: scroll; border: 1px solid #ccc; padding: 8px; box-sizing: border-box; font-family: monospace; border-radius: 5px; background-color: #f9f9f9; }
        #sitemapUrl, #printfriendlyApiKey, #issuuBearerToken, #issuuClientId, #issuuClientSecret, #urlFilter, .additional-api-key { width: 100%; margin-bottom: 8px; padding: 8px; box-sizing: border-box; border-radius: 5px; border: 1px solid #ccc; }
        .api-key-input, .sitemap-parser, .url-area, .results-area, .progress-area, .cors-info { margin-bottom: 15px; padding: 10px; border-radius: 8px; background-color: #fff; border: 1px solid #ddd; }
        .sitemap-parser { display: flex; }
        .sitemap-parser input { flex-grow: 1; margin-right: 10px; }
        .url-area { display: flex; }
        .url-area textarea { flex-grow: 2; margin-right: 10px; }
        .url-filter-area { flex-grow: 1; }
        .results-area { margin-top: 10px; display: flex; }
        .results-area textarea { flex: 1; height: 150px; margin-right: 10px; box-sizing: border-box; border-radius: 5px; border: 1px solid #ccc; padding: 8px; }
        .progress-area { margin-bottom: 10px; }
        .progress-bar { width: 100%; height: 20px; background-color: #eee; border-radius: 5px; overflow: hidden; }
        .progress-bar-fill { height: 100%; width: 0%; background-color: #4CAF50; border-radius: 5px; transition: width 0.3s ease-in-out; }
        .cors-info { background-color: #f0f0f0; padding: 10px; border: 1px solid #ccc; margin-bottom: 15px; border-radius: 5px; }
        .issuu-creds { display: flex; align-items: center; }
        .issuu-creds label { margin-right: 10px; white-space: nowrap; }
        .issuu-creds input { margin-right: 10px; flex: 1; }
        .api-keys-container { display: flex; flex-direction: column; }
        .additional-keys-container { display: flex; flex-wrap: wrap; align-items: center; margin-top: 5px; }
        .additional-keys-container label { margin-right: 10px; white-space: nowrap; margin-bottom: 5px; }
        .additional-keys-container input { flex: 1 1 200px; margin-right: 10px; margin-bottom: 5px; }
        h1, h2 {
            text-align: center;
            color: #333;
        }
        label { font-weight: bold; display: block; margin-bottom: 5px; color: #555; }
        p { color: #777; margin-bottom: 8px; }
        .url-filter-area p { margin-top: 5px; font-style: italic; color: #999; }
        .results-area button { margin-top: 10px; }

        /* Card Specific Styling (Keep existing card styles and adjust if needed) */
        .card {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            opacity: 1;
            transition: opacity 0.5s ease, transform 0.5s ease;
            transform: translateY(0);
        }

        .card.hidden {
            opacity: 0;
            transform: translateY(20px);
            pointer-events: none; /* Prevent interaction when hidden */
        }

        .card-header {
            text-align: center;
            margin-bottom: 15px;
        }

        .card-analysis, .card-topic {
            font-size: 0.9em;
            color: #777;
        }

        .card-question {
            font-weight: bold;
            margin-bottom: 10px;
            text-align: center;
        }

        /* Keep existing progress bar styles */
        .progress-container {
            margin-bottom: 20px;
            text-align: center;
        }

        .progress-bar-info {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 5px;
        }

        .progress-bar {
            background-color: #e0e0e0;
            border-radius: 5px;
            height: 10px;
            width: 100%;
            position: relative;
            overflow: hidden; /* Ensure rounded corners are visible */
        }

        .progress-bar-fill {
            background-color: #4caf50;
            height: 100%;
            width: 0%; /* Will be updated by JS */
            border-radius: 5px;
            transition: width 0.3s ease; /* Smooth transition for progress */
        }
        .progress-bar-segments {
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            width: 100%;
            display: flex;
            justify-content: flex-start; /* or space-around, space-between, etc. */
            align-items: center;
            pointer-events: none; /* Make sure clicks pass through to the bar */
        }

        .progress-segment {
            height: 100%;
            background-color: #4caf50;
            flex-grow: 1; /* Equal distribution of segments */
            border-right: 1px solid #e0e0e0; /* Segment separator */
            box-sizing: border-box; /* Include border in width calculation */
        }

        .progress-segment:last-child {
            border-right: none; /* No border on the last segment */
        }

        .progress-segment.unanswered {
            background-color: #ccc; /* Grey for unanswered segments */
        }


        /* Controls Styling */
        .controls {
            display: flex;
            justify-content: space-between;
        }

        .controls button {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            background-color: #f0f0f0; /* Updated to match new style */
            border: 1px solid #ccc; /* Updated to match new style */
            color: black; /* Set text color to black for better readability */
            cursor: pointer;
            font-size: 1em;
        }

        .controls button:hover {
            background-color: #e0e0e0; /* Hover effect */
        }

        .controls button:disabled {
            background-color: #eee; /* Disabled state background */
            color: #999;         /* Disabled state text color */
            cursor: default;
            border: 1px solid #ddd; /* Optional: slightly different border for disabled */
        }

        /* Report Section Styling - Keep as is unless you want to change */
        .report-section {
            margin-top: 30px;
            padding: 20px;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .user-info-section, .answers-section {
            margin-bottom: 20px;
        }

        .user-info-section h3, .answers-section h3 {
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
            margin-bottom: 15px;
        }

        .user-info-item, .answer-item {
            margin-bottom: 10px;
        }

        .answer-item .question-text {
            font-weight: bold;
            margin-bottom: 5px;
        }

        /* Initial User Info Form Styling - Keep as is unless you want to change */
        .user-info-form {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 20px;
            width: 100%;
            align-items: center;
        }

        .user-info-row {
            display: flex;
            gap: 15px;
            width: 100%;
            justify-content: space-around;
            align-items: flex-start;
        }

        .user-info-item-inline {
            display: flex;
            flex-direction: column;
            flex: 1;
            min-width: 0;
        }

        .user-info-form label {
            font-weight: bold;
            margin-bottom: 5px;
            text-align: left;
            display: block;
        }

        .user-info-form input, .user-info-form select {
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 5px;
            box-sizing: border-box;
            width: 100%;
        }

        .user-info-form button {
            align-self: center;
            padding: 10px 20px;
            cursor: pointer;
            border-radius: 5px;
            background-color: #f0f0f0;
            border: 1px solid #ccc;
            color: black;
            margin-top: 15px;
        }

        .user-info-form button:hover {
            background-color: #e0e0e0;
        }

        /* New Checkbox and Button Container Styling */
        .answer-confirmation {
            display: flex;
            flex-direction: column; /* Stack checkbox and button vertically */
            align-items: flex-start; /* Align items to the start */
            margin-top: 15px; /* Add some space above the checkbox */
        }

        .answer-confirmation label {
            display: inline-flex; /* Align checkbox and label text in one line */
            align-items: center; /* Vertically align checkbox and text */
            margin-bottom: 10px; /* Space between checkbox and button */
        }

        .answer-confirmation input[type="checkbox"] {
            margin-right: 8px; /* Space between checkbox and label text */
        }

        .answer-confirmation button {
            padding: 10px 20px;
            cursor: pointer;
            border-radius: 5px;
            background-color: #f0f0f0; /* Style to match other buttons */
            border: 1px solid #ccc;
        }

        .answer-confirmation button:hover {
            background-color: #e0e0e0; /* Hover effect */
        }

        .answer-confirmation button:disabled {
            background-color: #eee; /* Disabled state */
            color: #999;
            cursor: default;
            border: 1px solid #ddd;
        }

        /* User Info Display in Question Card */
        .card-user-info {
            text-align: center;
            margin-bottom: 10px;
            padding: 10px;
            background-color: #f9f9f9;
            border-radius: 5px;
            font-size: 0.9em;
            color: #555;
        }

        .card-user-info p {
            margin: 5px 0;
        }

        /* --- Modified CSS for Inline Buttons (Attempt 3 - inline-block) --- */
        .card-controls.combined-controls {
            display: block; /* Revert to block display for the container itself */
            margin-top: 15px; /* Add some space above controls in card */
            text-align: center; /* Center the whole control group horizontally */
        }

        .card-controls.combined-controls button {
            display: inline-block; /* Make buttons inline-block */
            width: 30%;          /* Set a fixed width for buttons (adjust as needed) */
            max-width: none;      /* Ensure buttons don't have max-width preventing inline layout */
            margin-right: 10px;    /* Add right margin to "Previous" button */
            margin-left: 0;       /* Reset left margin for "Previous" button */
            box-sizing: border-box; /* Include padding and border in width calculation */
            text-align: center;     /* Center text within buttons */
            vertical-align: middle; /* Vertically align buttons with checkbox */
        }

        .card-controls.combined-controls button#next-btn-question {
            margin-left: 10px;     /* Add left margin to "Next" button */
            margin-right: 0;      /* Reset right margin for "Next" button */
        }


        .card-controls.combined-controls label {
            display: block;
            text-align: center;
            margin-left: auto;
            margin-right: auto;
            margin-bottom: 30px;
        }

        #clear-data-btn {
            background-color: #f9d9d9; /* Light red background */
            color: #8a0000;         /* Darker red text */
            border: 1px solid #e0b0b0; /* Light red border */
        }

        #clear-data-btn:hover {
            background-color: #f0c0c0; /* Slightly darker red on hover */
        }

        /* --- Checkpoint Section Styling --- */
        #checkpoint-section, #topic-checkpoint-section, #topic-greeting-section {
            display: none; /* Initially hidden */
            width: 100%;
            align-items: center;
            flex-direction: column;
        }

        .checkpoint-cards-container, .topic-checkpoint-cards-container {
            display: flex;
            flex-wrap: wrap; /* Allow cards to wrap to the next line */
            justify-content: center; /* Center cards horizontally */
            gap: 20px; /* Spacing between cards */
            margin-bottom: 20px;
        }

        .checkpoint-card, .topic-checkpoint-card, .greeting-card { /* Added greeting-card class */
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            padding: 20px;
            width: 250px; /* Adjust card width as needed */
            text-align: center;
            cursor: pointer;
            transition: transform 0.2s ease-in-out;
            display: flex;
            flex-direction: column; /* Stack content vertically */
            align-items: center;
            justify-content: center;
            min-height: 150px; /* Minimum height for cards */
            font-weight: bold;
            font-size: 1.1em;
        }

        .greeting-card { /* Styling specifically for greeting cards if needed */
            min-height: auto; /* Adjust height for greeting cards */
            width: 90%;
            max-width: 600px;
            text-align: left; /* Align text to left in greeting card */
            margin-bottom: 30px; /* Add bottom margin for spacing */
            margin-left: auto;   /* To ensure horizontal centering */
            margin-right: auto;  /* To ensure horizontal centering */
            display: block;      /* Ensure it behaves as a block element for margin to work correctly */
        }

        .checkpoint-card:hover, .topic-checkpoint-card:hover, .greeting-card:hover {
            transform: scale(1.05);
        }

        .checkpoint-card.status-answered, .topic-checkpoint-card.status-answered {
            background-color: #d4edda; /* Light green */
            border: 2px solid #c3e6cb;
            position: relative;
        }

        /* --- CSS for "DONE" Stamp on Completed Cards --- */
        .checkpoint-card.status-answered::after,
        .topic-checkpoint-card.status-answered::after {
            content: 'DONE';
            position: absolute;
            bottom: 10px;
            right: 22%;
            display: flex;
            justify-content: center;
            align-items: center;
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background-color: rgba(255, 0, 0, 0);
            background-image: radial-gradient(circle at center, rgba(255, 0, 0, 0.1) 70%, rgba(255, 0, 0, 0.1) 70%, rgba(255, 0, 0, 0));
            color: darkred;
            font-family: 'Courier New', Courier, monospace;
            font-weight: 900;
            font-size: 3.1em;
            text-transform: uppercase;
            transform: rotate(-35deg);
            border: 8px solid darkred;
            box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.2), 0px 0px 0 #000, -1px -1px 0 darkred;
            pointer-events: none;
            opacity: 1;
            letter-spacing: -2px;
            text-shadow: 0px 0px 0 #000, -1px -1px 0 darkred;
        }

        .checkpoint-card.status-partially-answered, .topic-checkpoint-card.status-partially-answered {
            background-color: #fff3cd; /* Light yellow */
            border: 2px solid #ffeeba;
        }

        .checkpoint-card.status-not-answered, .topic-checkpoint-card.status-not-answered {
            background-color: #f8d7da; /* Light red */
            border: 2px solid #f5c6cb;
        }

        #see-report-btn, #go-to-main-checkpoint-btn, #go-to-topic-checkpoint-btn, #start-topic-btn, #next-topic-btn { /* Added new buttons */
            padding: 15px 30px;
            font-size: 1.2em;
            background-color: #4caf50;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            display: none; /* Initially hidden */
            margin-top: 20px;
        }

        #see-report-btn:hover, #go-to-main-checkpoint-btn:hover, #go-to-topic-checkpoint-btn:hover, #start-topic-btn:hover, #next-topic-btn:hover {
            background-color: #45a049;
        }

        .card-details { /* Style for details within checkpoint cards */
            font-size: 0.9em;
            color: #555;
            margin-top: 10px;
        }
        .card-details p {
            margin: 5px 0;
        }

        small.ctrl-enter-instruction {
            font-size: 0.8em;
            color: #777;
        }

        /* --- CSS for Analysis Completion Celebration --- */
        #analysis-completion-section {
            display: none; /* Hidden by default */
            position: fixed; /* Cover the whole viewport */
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.9); /* Semi-transparent white background */
            z-index: 1000; /* Ensure it's on top of everything */
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }

        .confetti-container, .balloon-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden; /* Clip overflowing particles/balloons */
            pointer-events: none; /* Allow clicks to pass through */
        }

        /* --- Confetti Styling and Animation --- */
        .confetti {
            position: absolute;
            width: 8px;
            height: 8px;
            background-color: #f09433; /* Example confetti color - orange */
            border-radius: 50%;
            opacity: 0; /* Start invisible */
            animation: confetti-fall 3s linear forwards, confetti-rotate 1s infinite linear;
            z-index: 1; /* Confetti below balloons */
        }

        @keyframes confetti-fall {
            0% { top: -10%; opacity: 1; }
            100% { top: 110%; opacity: 0; }
        }

        @keyframes confetti-rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* --- Balloon Styling and Animation --- */
        .balloon {
            position: absolute;
            width: 40px;
            height: 60px;
            border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%; /* Balloon shape */
            background-color: #3498db; /* Example balloon color - blue */
            opacity: 0; /* Start invisible */
            animation: balloon-float 4s ease-out forwards, balloon-sway 2s infinite alternate ease-in-out;
            z-index: 2; /* Balloons above confetti */
        }

        @keyframes balloon-float {
            0% { transform: translateY(110%); opacity: 1; }
            100% { transform: translateY(-10%); opacity: 0; }
        }

        @keyframes balloon-sway {
            0% { transform: translateX(0); }
            100% { transform: translateX(10px); }
        }


        .celebration-message {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            z-index: 3; /* Message above balloons and confetti */
            margin-bottom: 20px;
        }

        #go-to-checkpoint-button {
            padding: 15px 30px;
            font-size: 1.1em;
            cursor: pointer;
            border-radius: 8px;
            background-color: #4caf50;
            color: white;
            border: none;
            z-index: 3; /* Button above balloons and confetti */
        }

        #go-to-checkpoint-button:hover {
            background-color: #45a049;
        }

    </style>
</head>
<body>
    <div class="container">
        <h1>RJPP v1.83<br>Rencana Jangka Panjang Perusahaan 🚀</h1>

        <div id="user-info-form-section">
            <h2>Informasi Perusahaan dan Pengguna 👤🏢</h2>
            <form id="user-info-form" class="user-info-form">
                <div class="user-info-row">
                    <div class="user-info-item-inline">
                        <label for="fullName">Nama Lengkap 🧑:</label>
                        <input type="text" id="fullName" name="fullName" required>
                    </div>
                    <div class="user-info-item-inline">
                        <label for="companyName">Nama Perusahaan 🏢:</label>
                        <input type="text" id="companyName" name="companyName" required>
                    </div>
                    <div class="user-info-item-inline">
                        <label for="position">Jabatan 💼:</label>
                        <input type="text" id="position" name="position" required>
                    </div>
                </div>

                <div class="user-info-row">
                    <div class="user-info-item-inline">
                        <label for="industry">Industri 🏭:</label>
                        <input type="text" id="industry" name="industry" required>
                    </div>
                    <div class="user-info-item-inline">
                        <label for="productService">Produk / Jasa 📦:</label>
                        <input type="text" id="productService" name="productService" required>
                    </div>
                    <div class="user-info-item-inline">
                        <label for="companySize">Ukuran Perusahaan 📏:</label>
                        <select id="companySize" name="companySize" required>
                            <option value="">Pilih Ukuran</option>
                            <option value="small">Kecil</option>
                            <option value="medium">Menengah</option>
                            <option value="large">Besar</option>
                        </select>
                    </div>
                </div>

                <button type="submit">Mulai Analisis 🚀</button>
            </form>
        </div>

        <div id="checkpoint-section" style="display: none;">
            <h2>Pengisian Data Analisis Penyusunan RJPP<br>Pilih Jenis Analisis 👇🏻</h2>
            <p style="text-align: center;">💡 Silakan lengkapi data untuk masing-masing analisis terkait perusahaan anda berikut ini. </p>
            <div id="checkpoint-cards-container" class="checkpoint-cards-container">
                <!-- Analysis checkpoint cards will be generated here by JavaScript -->
            </div>
            <button id="see-report-btn" style="display: none;">Lihat Laporan RJPP 📝</button>
        </div>

        <div id="topic-checkpoint-section" style="display: none;">
            <h2>🎯 <span id="topic-checkpoint-analysis-name"></span> 🎯<br>Pilih Topik Analisis 👇🏻</h2>
            <div id="topic-checkpoint-cards-container" class="topic-checkpoint-cards-container">
                <!-- Topic checkpoint cards will be generated here by JavaScript -->
            </div>
            <center style="margin-bottom: 30px;"><button id="go-to-main-checkpoint-btn" style="display: none;">⬅️ Kembali ke Daftar Analisis Utama</button></center>
        </div>

        <div id="topic-greeting-section" style="display: none;">
            <div id="topic-greeting-card" class="greeting-card">
                <h2 id="topic-greeting-title"></h2>
                <p id="topic-greeting-description"></p>
                <center><button id="start-topic-btn" style="display: none;">Mulai Survei Topik Ini 🚀</button></center>
                <center><button id="next-topic-btn" style="display: none;">Lanjut ke Topik Berikutnya ➡️</button></center>
                <center><button id="go-to-topic-checkpoint-btn" style="display: none;">Lihat Daftar Topik Analisis 🗂️</button></center>
                <center><button id="go-to-main-checkpoint-btn" style="display: none;">⬅️ Kembali ke Daftar Analisis Utama</button></center>
            </div>
        </div>

        <div id="question-section" style="display: none;">
            <div class="progress-container">
                <div class="progress-bar-info">
                    <span id="question-number"></span> 📊
                </div>
                <div class="progress-bar">
                    <div class="progress-bar-segments" id="progress-segments"></div>
                    <div class="progress-bar-fill" id="progress-fill"></div>
                </div>
            </div>

            <div id="question-card" class="card">
                <div class="card-user-info" id="card-user-info-display">
                    <!-- User info will be displayed here -->
                </div>
                <div class="card-header">
                    <div class="card-analysis" id="card-analysis-title">Analisis: [Nama Analisis] </div>
                    <div class="card-topic" id="card-topic-title">Topik: [Nama Topik] </div>
                </div>
                <div class="card-question" id="card-question-text">[Pertanyaan akan muncul di sini] 🤔</div>
                <textarea id="answer-textarea" placeholder="Jawaban Anda"></textarea>
                <center><small class="ctrl-enter-instruction">💡 Anda bisa menekan Ctrl + Enter di keyboard untuk mengkonfirmasi jawaban ini dan lanjut ke pertanyaan berikutnya.</small></center>

                <div class="answer-confirmation card-controls combined-controls">
                    <label>
                        <input type="checkbox" id="confirm-answer-checkbox"> ✅ Saya yakin dengan jawaban ini
                    </label>
                    <button id="prev-btn">⬅️ Sebelumnya</button>
                    <button id="next-btn-question" disabled>Selanjutnya ➡️</button>
                </div>
            </div>
        </div>

        <div id="analysis-completion-section" style="display: none;">
            <div class="confetti-container"></div> <!-- Container for confetti -->
            <div class="balloon-container"></div> <!-- Container for balloons -->
            <div class="celebration-message">
                <h2>🎉 Selamat! 🎉</h2>
                <p>Anda telah menyelesaikan seluruh analisis <span id="completed-analysis-name" style="font-weight: bold;">[Analysis Name]</span>!</p>
                <p>Bersiaplah untuk analisis berikutnya!</p>
            </div>
            <button id="go-to-checkpoint-button">Lanjut ke Daftar Analisis Utama 🚀</button>
        </div>

        <div id="report-section" class="report-section" style="display: none;">
            <h2>Laporan RJPP 📝</h2>
            <div class="user-info-section">
                <h3>Informasi Perusahaan dan Pengguna 👤🏢</h3>
                <div id="report-user-info"></div>
            </div>
            <div class="answers-section">
                <h3>Jawaban Analisis 💡</h3>
                <div id="report-answers"></div>
            </div>
            <button id="download-pdf-btn">Unduh PDF ⬇️ (Coming Soon)</button>
        </div>
        <button id="clear-data-btn">🗑️ Remove All Data</button>
    </div>
    <script>
        // --- Question Data (Placeholder - Replace with your actual data) ---
        const questionsData = {
            "Informasi Umum Perusahaan": {
                "Gambaran Umum": [
                    { question: "Apa ringkasan eksekutif (Executive Summary) perusahaan Anda, ${companyName}?", answerKey: "company_overview_executive_summary" },
                    { question: "Apa visi utama ${companyName}?", answerKey: "company_overview_visi" },
                    { question: "Apa misi utama ${companyName}?", answerKey: "company_overview_misi" },
                    { question: "Sebutkan aktivitas usaha utama ${companyName}.", answerKey: "company_overview_aktivitas_usaha" }
                ],
                "Pendahuluan Perusahaan": [
                    { question: "Jelaskan secara singkat latar belakang dan sejarah ${companyName}.", answerKey: "company_introduction_latar_belakang_sejarah" },
                    { question: "Visi ${companyName} secara detail?", answerKey: "company_introduction_visi_detail" },
                    { question: "Misi ${companyName} secara detail?", answerKey: "company_introduction_misi_detail" },
                    { question: "Sebutkan nilai-nilai perusahaan ${companyName}.", answerKey: "company_introduction_nilai_nilai_perusahaan" },
                    { question: "Jelaskan nilai-nilai perusahaan ${companyName} tersebut.", answerKey: "company_introduction_nilai_nilai_perusahaan_detail" },
                    { question: "Apa tujuan jangka panjang utama ${companyName}?", answerKey: "company_introduction_tujuan_perusahaan_jangka_panjang" },
                    { question: "Ke arah mana pengembangan ${companyName} di masa depan?", answerKey: "company_introduction_arah_pengembangan_perusahaan" },
                    { question: "Bagaimana struktur organisasi di ${companyName}?", answerKey: "company_introduction_struktur_organisasi" },
                    { question: "Siapa saja Dewan Komisaris di ${companyName}?", answerKey: "company_introduction_susunan_dewan_komisaris" },
                    { question: "Siapa saja Direksi di ${companyName}?", answerKey: "company_introduction_susunan_direksi" },
                    { question: "Bagaimana pengelolaan SDM di ${companyName}?", answerKey: "company_introduction_sdm" },
                    {
                        question: "Apakah ${companyName} memiliki perusahaan anak?",
                        answerKey: "company_introduction_punya_perusahaan_anak",
                        type: "yesno",
                        followUpQuestions: [
                            { question: "Sebutkan perusahaan anak ${companyName}.", answerKey: "company_introduction_sebutkan_perusahaan_anak" },
                            { question: "Jelaskan secara singkat tentang masing-masing perusahaan anak tersebut.", answerKey: "company_introduction_jelaskan_perusahaan_anak" }
                        ]
                    }
                ],
                "Evaluasi RJPP Sebelumnya": [
                    {
                        question: "Apakah ${companyName} pernah menyusun RJPP sebelumnya?",
                        answerKey: "rjp_evaluation_pernah_rjpp_sebelumnya",
                        type: "yesno",
                        followUpQuestions: [
                            { question: "Bagaimana evaluasi pelaksanaan RJPP ${companyName} sebelumnya?", answerKey: "rjp_evaluation_evaluasi_pelaksanaan_rjpp" },
                            { question: "Bagaimana evaluasi kinerja keuangan ${companyName} di RJPP sebelumnya?", answerKey: "rjp_evaluation_evaluasi_kinerja_keuangan" },
                            { question: "Bagaimana evaluasi strategi di RJPP sebelumnya?", answerKey: "rjp_evaluation_evaluasi_pelaksanaan_strategi" }
                        ]
                    }
                ]
            },
            "Kerangka Porter's Diamond (Diamond Strategy)": {
                "Kondisi Faktor Produksi": [
                    { question: "Apakah negara tempat ${companyName} beroperasi memiliki sumber daya alam yang melimpah dan relevan dengan industri Anda?", answerKey: "diamond_factor_conditions_resources" },
                    { question: "Bagaimana kualitas infrastruktur di negara ini (misalnya, transportasi, komunikasi, energi) yang mendukung operasional ${companyName}?", answerKey: "diamond_factor_conditions_infrastructure" },
                    { question: "Apakah ada lembaga pendidikan dan pelatihan yang berkualitas di negara ini untuk menghasilkan tenaga kerja terampil yang dibutuhkan ${companyName}?", answerKey: "diamond_factor_conditions_education" },
                    { question: "Seberapa mudah ${companyName} mengakses modal dan teknologi yang dibutuhkan untuk pengembangan usaha?", answerKey: "diamond_factor_conditions_capital_tech" },
                    { question: "Apakah iklim investasi di negara ini kondusif bagi pertumbuhan dan perkembangan ${companyName}?", answerKey: "diamond_factor_conditions_investment_climate" }
                ],
                "Kondisi Permintaan": [
                    { question: "Seberapa besar pasar domestik untuk produk/jasa ${companyName} saat ini?", answerKey: "diamond_demand_conditions_market_size" },
                    { question: "Seberapa cepat pertumbuhan pasar domestik untuk produk/jasa ${companyName}?", answerKey: "diamond_demand_conditions_market_growth" },
                    { question: "Apakah konsumen domestik memiliki preferensi khusus atau harapan tinggi yang mendorong ${companyName} untuk berinovasi?", answerKey: "diamond_demand_conditions_consumer_preference" },
                    { question: "Apakah ada segmen pasar domestik yang belum terlayani atau memiliki kebutuhan khusus yang bisa dipenuhi ${companyName}?", answerKey: "diamond_demand_conditions_untapped_segment" },
                    { question: "Seberapa tinggi tingkat kesadaran dan permintaan terhadap produk/jasa ${companyName} di pasar domestik?", answerKey: "diamond_demand_conditions_market_awareness" }
                ],
                "Industri Terkait dan Pendukung": [
                    { question: "Apakah ada industri terkait yang kuat dan kompetitif di negara ini yang dapat mendukung ${companyName}?", answerKey: "diamond_related_supporting_strong_related_industry" },
                    { question: "Apakah ada industri pendukung yang menyediakan input, teknologi, atau layanan berkualitas yang dibutuhkan ${companyName}?", answerKey: "diamond_related_supporting_quality_support_industry" },
                    { question: "Apakah ada klaster industri yang terintegrasi dan saling mendukung di mana ${companyName} dapat berpartisipasi?", answerKey: "diamond_related_supporting_industry_cluster" },
                    { question: "Seberapa kuat jaringan kerjasama antar perusahaan dalam industri ${companyName}?", answerKey: "diamond_related_supporting_industry_network" }
                ],
                "Strategi, Struktur, dan Persaingan Perusahaan": [
                    { question: "Bagaimana tingkat persaingan di antara perusahaan domestik dalam industri ${companyName}?", answerKey: "diamond_firm_strategy_domestic_competition_level" },
                    { question: "Bagaimana perusahaan domestik bersaing di industri ${companyName}?", answerKey: "diamond_firm_strategy_domestic_competition_style" },
                    { question: "Apakah ${companyName} memiliki strategi dan struktur yang inovatif dan efisien?", answerKey: "diamond_firm_strategy_innovative_efficient_strategy" },
                    { question: "Apakah ada budaya persaingan yang sehat dan mendorong inovasi di industri ${companyName}?", answerKey: "diamond_firm_strategy_healthy_competition_culture" },
                    { question: "Faktor-faktor apa saja yang mendorong persaingan di pasar domestik ${companyName}?", answerKey: "diamond_firm_strategy_competition_drivers" }
                ],
                "Kebijakan Pemerintah": [
                    { question: "Apakah kebijakan pemerintah saat ini mendukung pengembangan industri ${companyName}?", answerKey: "diamond_government_policy_industry_support" },
                    { question: "Apakah ada insentif atau subsidi yang diberikan pemerintah kepada perusahaan dalam industri ${companyName}?", answerKey: "diamond_government_policy_incentives_subsidies" },
                    { question: "Bagaimana regulasi pemerintah mempengaruhi industri ${companyName}?", answerKey: "diamond_government_policy_regulations_impact" },
                    { question: "Apakah pemerintah mendorong investasi dalam riset dan pengembangan di industri ${companyName}?", answerKey: "diamond_government_policy_rd_investment" }
                ],
                "Kebetulan": [
                    { question: "Apakah ada peristiwa tak terduga yang dapat menciptakan peluang atau ancaman bagi industri ${companyName}?", answerKey: "diamond_chance_unexpected_events_impact" },
                    { question: "Bagaimana ${companyName} dapat mengantisipasi dan merespons peristiwa tak terduga tersebut?", answerKey: "diamond_chance_unexpected_events_response" },
                    { question: "Apakah ${companyName} memiliki rencana kontingensi untuk menghadapi kejadian tak terduga?", answerKey: "diamond_chance_contingency_plan" }
                ]
            },
            "Balanced Scorecard": {
                "Keuangan": [
                    { question: "Bagaimana kinerja keuangan ${companyName} saat ini (misalnya, pendapatan, profitabilitas, arus kas)?", answerKey: "balanced_scorecard_financial_current_performance" },
                    { question: "Apa tujuan keuangan jangka panjang ${companyName}?", answerKey: "balanced_scorecard_financial_long_term_goals" },
                    { question: "Bagaimana ${companyName} dapat meningkatkan kinerja keuangan?", answerKey: "balanced_scorecard_financial_improve_performance" },
                    { question: "Bagaimana ${companyName} dapat mencapai tujuan keuangan jangka panjang?", answerKey: "balanced_scorecard_financial_achieve_long_term_goals" },
                    { question: "Indikator kinerja keuangan kunci apa saja yang relevan untuk ${companyName}?", answerKey: "balanced_scorecard_financial_key_indicators" }
                ],
                "Pelanggan": [
                    { question: "Bagaimana tingkat kepuasan pelanggan ${companyName} saat ini?", answerKey: "balanced_scorecard_customer_current_satisfaction" },
                    { question: "Apa yang diharapkan pelanggan dari ${companyName}?", answerKey: "balanced_scorecard_customer_expectations" },
                    { question: "Bagaimana ${companyName} dapat meningkatkan kepuasan pelanggan?", answerKey: "balanced_scorecard_customer_improve_satisfaction" },
                    { question: "Bagaimana ${companyName} dapat membangun loyalitas pelanggan?", answerKey: "balanced_scorecard_customer_build_loyalty" },
                    { question: "Indikator kinerja pelanggan kunci apa saja yang relevan untuk ${companyName} (misalnya, pangsa pasar, retensi pelanggan, akuisisi pelanggan)?", answerKey: "balanced_scorecard_customer_key_indicators" }
                ],
                "Proses Internal": [
                    { question: "Seberapa efisien dan efektif proses internal ${companyName}?", answerKey: "balanced_scorecard_internal_process_efficiency_effectiveness" },
                    { question: "Apakah ada area di mana ${companyName} dapat meningkatkan proses internal?", answerKey: "balanced_scorecard_internal_process_improvement_areas" },
                    { question: "Bagaimana ${companyName} dapat mengoptimalkan rantai nilai perusahaan?", answerKey: "balanced_scorecard_internal_process_value_chain_optimization" },
                    { question: "Bagaimana ${companyName} dapat menciptakan nilai tambah melalui proses internal?", answerKey: "balanced_scorecard_internal_process_value_creation" },
                    { question: "Proses internal kunci apa saja yang perlu diunggulkan ${companyName} untuk mencapai tujuan perusahaan?", answerKey: "balanced_scorecard_internal_process_key_processes" }
                ],
                "Pembelajaran & Pertumbuhan": [
                    { question: "Bagaimana ${companyName} dapat meningkatkan kompetensi dan kemampuan karyawan?", answerKey: "balanced_scorecard_learning_growth_improve_competency" },
                    { question: "Apakah ${companyName} memiliki program pelatihan dan pengembangan karyawan yang efektif?", answerKey: "balanced_scorecard_learning_growth_effective_training_programs" },
                    { question: "Bagaimana ${companyName} dapat mendorong inovasi dan pembelajaran organisasi?", answerKey: "balanced_scorecard_learning_growth_foster_innovation" },
                    { question: "Faktor pendorong pembelajaran dan pertumbuhan apa saja yang perlu ditingkatkan ${companyName}?", answerKey: "balanced_scorecard_learning_growth_improvement_drivers" }
                ]
            },
            "Blue Ocean Strategy": {
                "Batasan Pasar yang Ada": [
                    { question: "Apa saja batasan pasar yang ada saat ini di industri ${companyName}?", answerKey: "blue_ocean_market_boundaries_current_boundaries" },
                    { question: "Asumsi apa saja yang mendasari persaingan di pasar ${companyName}?", answerKey: "blue_ocean_market_boundaries_competition_assumptions" },
                    { question: "Bagaimana ${companyName} dan pesaing mendefinisikan produk/jasa dan target pasar?", answerKey: "blue_ocean_market_boundaries_product_definition" }
                ],
                "Faktor Persaingan Utama": [
                    { question: "Faktor-faktor apa saja yang menjadi dasar persaingan di pasar ${companyName}?", answerKey: "blue_ocean_competition_factors_basis_of_competition" },
                    { question: "Bagaimana ${companyName} dan pesaing bersaing dalam faktor-faktor tersebut?", answerKey: "blue_ocean_competition_factors_competition_style" },
                    { question: "Apakah ada faktor-faktor yang dianggap penting tetapi sebenarnya tidak memberikan nilai tambah bagi pelanggan ${companyName}?", answerKey: "blue_ocean_competition_factors_non_value_added_factors" }
                ],
                "Nilai Tambah bagi Pelanggan": [
                    { question: "Nilai tambah apa saja yang diharapkan pelanggan dari produk/jasa di industri ${companyName}?", answerKey: "blue_ocean_customer_value_expected_value" },
                    { question: "Bagaimana ${companyName} dan pesaing memberikan nilai tambah kepada pelanggan?", answerKey: "blue_ocean_customer_value_delivered_value" },
                    { question: "Apakah ada kebutuhan pelanggan yang belum terpenuhi atau terabaikan oleh ${companyName} dan pesaing?", answerKey: "blue_ocean_customer_value_unmet_needs" }
                ],
                "Non-Pelanggan": [
                    { question: "Siapa saja non-pelanggan yang mungkin tertarik dengan produk/jasa baru dari ${companyName}?", answerKey: "blue_ocean_non_customers_potential_non_customers" },
                    { question: "Apa saja kebutuhan dan harapan non-pelanggan ${companyName}?", answerKey: "blue_ocean_non_customers_non_customer_needs" },
                    { question: "Bagaimana ${companyName} dapat menjangkau dan menarik non-pelanggan?", answerKey: "blue_ocean_non_customers_reach_non_customers" }
                ],
                "Kerangka Empat Tindakan": [
                    { question: "Faktor-faktor apa yang dapat dihilangkan ${companyName} dari standar industri?", answerKey: "blue_ocean_four_actions_eliminate" },
                    { question: "Faktor-faktor apa yang dapat dikurangi ${companyName} di bawah standar industri?", answerKey: "blue_ocean_four_actions_reduce" },
                    { question: "Faktor-faktor apa yang dapat ditingkatkan ${companyName} di atas standar industri?", answerKey: "blue_ocean_four_actions_raise" },
                    { question: "Faktor-faktor apa yang dapat diciptakan ${companyName} yang belum pernah ada di industri ini?", answerKey: "blue_ocean_four_actions_create" }
                ],
                "Kurva Nilai Baru": [
                    { question: "Bagaimana kurva nilai produk/jasa baru ${companyName} dibandingkan dengan kurva nilai produk/jasa yang sudah ada?", answerKey: "blue_ocean_value_curve_new_vs_existing" },
                    { question: "Bagaimana kurva nilai baru ${companyName} dapat menciptakan nilai tambah yang signifikan bagi pelanggan dan non-pelanggan?", answerKey: "blue_ocean_value_curve_new_value_creation" }
                ],
                "Model Bisnis yang Baru": [
                    { question: "Bagaimana model bisnis baru ${companyName} dapat mendukung penciptaan blue ocean?", answerKey: "blue_ocean_business_model_support_blue_ocean" },
                    { question: "Bagaimana ${companyName} dapat menghasilkan keuntungan dari blue ocean yang diciptakan?", answerKey: "blue_ocean_business_model_profitability" },
                    { question: "Bagaimana ${companyName} dapat mempertahankan keunggulan kompetitif di blue ocean?", answerKey: "blue_ocean_business_model_competitive_advantage" }
                ]
            },
            "Daya Tarik Daya Saing (Industry and Competitive Analysis)": {
                "Pangsa Pasar": [
                    { question: "Berapa pangsa pasar ${companyName} saat ini?", answerKey: "competitive_analysis_market_share_current_share" },
                    { question: "Bagaimana pangsa pasar ${companyName} dibandingkan dengan pesaing utama?", answerKey: "competitive_analysis_market_share_vs_competitors" },
                    { question: "Bagaimana tren pangsa pasar ${companyName} dari waktu ke waktu?", answerKey: "competitive_analysis_market_share_market_share_trend" }
                ],
                "Pertumbuhan Pasar": [
                    { question: "Seberapa cepat pertumbuhan pasar di industri ${companyName}?", answerKey: "competitive_analysis_market_growth_growth_rate" },
                    { question: "Faktor-faktor apa yang mendorong atau menghambat pertumbuhan pasar ${companyName}?", answerKey: "competitive_analysis_market_growth_growth_drivers" },
                    { question: "Bagaimana proyeksi pertumbuhan pasar ${companyName} di masa depan?", answerKey: "competitive_analysis_market_growth_future_projection" }
                ],
                "Profitabilitas": [
                    { question: "Seberapa menguntungkan industri ${companyName} secara keseluruhan?", answerKey: "competitive_analysis_profitability_industry_profitability" },
                    { question: "Bagaimana profitabilitas ${companyName} dibandingkan dengan pesaing utama?", answerKey: "competitive_analysis_profitability_company_vs_competitors" },
                    { question: "Faktor-faktor apa yang mempengaruhi profitabilitas di industri ${companyName}?", answerKey: "competitive_analysis_profitability_profitability_drivers" }
                ],
                "Intensitas Persaingan": [
                    { question: "Seberapa intens persaingan di industri ${companyName}?", answerKey: "competitive_analysis_competition_intensity_intensity_level" },
                    { question: "Strategi apa saja yang digunakan oleh pesaing utama ${companyName}?", answerKey: "competitive_analysis_competition_intensity_competitor_strategies" },
                    { question: "Bagaimana tingkat konsentrasi pasar di industri ${companyName}?", answerKey: "competitive_analysis_competition_intensity_market_concentration" }
                ],
                "Struktur Biaya": [
                    { question: "Bagaimana struktur biaya di industri ${companyName}?", answerKey: "competitive_analysis_cost_structure_industry_cost_structure" },
                    { question: "Apakah ada peluang untuk mencapai skala ekonomi atau efisiensi biaya di ${companyName}?", answerKey: "competitive_analysis_cost_structure_economies_of_scale" },
                    { question: "Bagaimana ${companyName} dapat mengoptimalkan struktur biaya?", answerKey: "competitive_analysis_cost_structure_cost_optimization" }
                ],
                "Tingkat Diferensiasi Produk": [
                    { question: "Seberapa mudah produk/jasa di industri ${companyName} dibedakan?", answerKey: "competitive_analysis_product_differentiation_differentiation_level" },
                    { question: "Faktor-faktor apa saja yang mendorong diferensiasi produk di industri ${companyName}?", answerKey: "competitive_analysis_product_differentiation_differentiation_drivers" },
                    { question: "Bagaimana ${companyName} dapat menciptakan dan mempertahankan diferensiasi produk?", answerKey: "competitive_analysis_product_differentiation_achieve_differentiation" }
                ],
                "Hambatan Masuk dan Keluar": [
                    { question: "Seberapa mudah bagi perusahaan baru untuk masuk atau keluar dari industri ${companyName}?", answerKey: "competitive_analysis_entry_barriers_ease_of_entry" },
                    { question: "Hambatan masuk dan keluar apa saja yang ada di industri ${companyName}?", answerKey: "competitive_analysis_entry_barriers_specific_barriers" },
                    { question: "Bagaimana ${companyName} dapat memanfaatkan hambatan masuk untuk melindungi posisinya?", answerKey: "competitive_analysis_entry_barriers_leverage_barriers" }
                ],
                "Pengaruh Faktor Eksternal": [
                    { question: "Bagaimana pengaruh faktor-faktor eksternal, seperti peraturan pemerintah, teknologi, dan kondisi ekonomi, terhadap industri ${companyName}?", answerKey: "competitive_analysis_external_factors_external_impact" },
                    { question: "Bagaimana ${companyName} dapat mengantisipasi dan merespons perubahan faktor eksternal?", answerKey: "competitive_analysis_external_factors_respond_external_changes" }
                ]
            },
            "Teknologi dan Digitalisasi": {
                "Tren Teknologi": [
                    { question: "Tren teknologi terbaru apa saja yang relevan dengan industri dan ${companyName}?", answerKey: "tech_digital_tech_trends_relevant_trends" },
                    { question: "Bagaimana tren teknologi ini dapat mempengaruhi bisnis ${companyName} di masa depan?", answerKey: "tech_digital_tech_trends_future_impact" },
                    { question: "Apakah ${companyName} mengikuti perkembangan teknologi terbaru?", answerKey: "tech_digital_tech_trends_tech_adoption" },
                    { question: "Bagaimana ${companyName} dapat memanfaatkan tren teknologi untuk menciptakan keunggulan kompetitif?", answerKey: "tech_digital_tech_trends_competitive_advantage" }
                ],
                "Infrastruktur Teknologi": [
                    { question: "Bagaimana infrastruktur teknologi ${companyName} saat ini?", answerKey: "tech_digital_tech_infrastructure_current_infrastructure" },
                    { question: "Apakah infrastruktur teknologi ${companyName} cukup kuat dan andal untuk mendukung operasional bisnis?", answerKey: "tech_digital_tech_infrastructure_infrastructure_strength" },
                    { question: "Apakah ada kebutuhan untuk meningkatkan infrastruktur teknologi ${companyName}?", answerKey: "tech_digital_tech_infrastructure_improvement_needs" },
                    { question: "Bagaimana infrastruktur teknologi ${companyName} dibandingkan dengan pesaing utama?", answerKey: "tech_digital_tech_infrastructure_vs_competitors" }
                ],
                "Digitalisasi Proses Bisnis": [
                    { question: "Bagaimana cara manfaatkan teknologi digital tingkatkan efisiensi proses bisnis?", answerKey: "tech_digital_digital_process_digital_adoption" },
                    { question: "Proses bisnis bisa diotomatisasi/digitalisasi?", answerKey: "tech_digital_digital_process_automation_potential" },
                    { question: "Bagaimana cara integrasikan teknologi digital ke operasional bisnis?", answerKey: "tech_digital_digital_process_integration" },
                    { question: "Digitalisasi proses bisnis vs pesaing utama?", answerKey: "tech_digital_digital_process_vs_competitors" }
                ],
                "Data dan Analitik": [
                    { question: "Bagaimana ${companyName} mengumpulkan, mengelola, dan menganalisis data?", answerKey: "tech_digital_data_analytics_data_management" },
                    { question: "Apakah ${companyName} memanfaatkan data untuk pengambilan keputusan bisnis?", answerKey: "tech_digital_data_analytics_data_driven_decisions" },
                    { question: "Apakah ${companyName} memiliki kemampuan analitik yang memadai?", answerKey: "tech_digital_data_analytics_analytical_capabilities" },
                    { question: "Bagaimana pemanfaatan data dan analitik ${companyName} dibandingkan dengan pesaing utama?", answerKey: "tech_digital_data_analytics_vs_competitors" }
                ],
                "Keamanan Siber": [
                    { question: "Bagaimana ${companyName} melindungi data dan sistemnya dari ancaman keamanan siber?", answerKey: "tech_digital_cyber_security_security_measures" },
                    { question: "Apakah ${companyName} memiliki kebijakan dan prosedur keamanan siber yang memadai?", answerKey: "tech_digital_cyber_security_security_policies" },
                    { question: "Apakah ${companyName} memiliki tim keamanan siber yang kompeten?", answerKey: "tech_digital_cyber_security_security_team" },
                    { question: "Bagaimana keamanan siber ${companyName} dibandingkan dengan pesaing utama?", answerKey: "tech_digital_cyber_security_vs_competitors" }
                ],
                "Inovasi Digital": [
                    { question: "Bagaimana ${companyName} mendorong inovasi digital?", answerKey: "tech_digital_digital_innovation_innovation_strategy" },
                    { question: "Apakah ${companyName} memiliki budaya inovasi yang kuat?", answerKey: "tech_digital_digital_innovation_innovation_culture" },
                    { question: "Apakah ${companyName} berinvestasi dalam penelitian dan pengembangan teknologi digital?", answerKey: "tech_digital_digital_innovation_rd_investment" },
                    { question: "Bagaimana inovasi digital ${companyName} dibandingkan dengan pesaing utama?", answerKey: "tech_digital_digital_innovation_vs_competitors" }
                ]
            },
            "Desain Organisasi yang Adaptif": {
                "Struktur Organisasi": [
                    { question: "Bagaimana struktur organisasi ${companyName} saat ini?", answerKey: "adaptive_org_design_org_structure_current_structure" },
                    { question: "Apakah struktur organisasi saat ini mendukung pencapaian tujuan strategis ${companyName}?", answerKey: "adaptive_org_design_org_structure_strategic_alignment" },
                    { question: "Apakah ada kebutuhan untuk mengubah struktur organisasi agar lebih adaptif dan responsif terhadap perubahan lingkungan bisnis ${companyName}?", answerKey: "adaptive_org_design_org_structure_need_for_change" },
                    { question: "Bagaimana struktur organisasi ${companyName} dibandingkan dengan pesaing utama?", answerKey: "adaptive_org_design_org_structure_vs_competitors" }
                ],
                "Budaya Organisasi": [
                    { question: "Bagaimana budaya organisasi ${companyName} saat ini?", answerKey: "adaptive_org_design_org_culture_current_culture" },
                    { question: "Apakah budaya organisasi saat ini mendukung inovasi, kolaborasi, dan pembelajaran di ${companyName}?", answerKey: "adaptive_org_design_org_culture_culture_alignment" },
                    { question: "Apakah ada kebutuhan untuk mengubah budaya organisasi agar lebih adaptif dan responsif terhadap perubahan lingkungan bisnis ${companyName}?", answerKey: "adaptive_org_design_org_culture_need_for_change" },
                    { question: "Bagaimana budaya organisasi ${companyName} dibandingkan dengan pesaing utama?", answerKey: "adaptive_org_design_org_culture_vs_competitors" }
                ],
                "Proses Pengambilan Keputusan": [
                    { question: "Bagaimana proses pengambilan keputusan di ${companyName} saat ini?", answerKey: "adaptive_org_design_decision_process_current_process" },
                    { question: "Apakah proses pengambilan keputusan saat ini cukup cepat dan efektif di ${companyName}?", answerKey: "adaptive_org_design_decision_process_effectiveness" },
                    { question: "Apakah ada kebutuhan untuk mengubah proses pengambilan keputusan agar lebih adaptif dan responsif terhadap perubahan lingkungan bisnis ${companyName}?", answerKey: "adaptive_org_design_decision_process_need_for_change" },
                    { question: "Bagaimana proses pengambilan keputusan ${companyName} dibandingkan dengan pesaing utama?", answerKey: "adaptive_org_design_decision_process_vs_competitors" }
                ],
                "Komunikasi dan Kolaborasi": [
                    { question: "Bagaimana komunikasi dan kolaborasi antar departemen dan tim di ${companyName} saat ini?", answerKey: "adaptive_org_design_communication_collaboration_current_state" },
                    { question: "Apakah komunikasi dan kolaborasi saat ini cukup efektif di ${companyName}?", answerKey: "adaptive_org_design_communication_collaboration_effectiveness" },
                    { question: "Apakah ada kebutuhan untuk meningkatkan komunikasi dan kolaborasi agar lebih adaptif dan responsif terhadap perubahan lingkungan bisnis ${companyName}?", answerKey: "adaptive_org_design_communication_collaboration_need_for_improvement" },
                    { question: "Bagaimana komunikasi dan kolaborasi ${companyName} dibandingkan dengan pesaing utama?", answerKey: "adaptive_org_design_communication_collaboration_vs_competitors" }
                ],
                "Manajemen Perubahan": [
                    { question: "Bagaimana ${companyName} mengelola perubahan saat ini?", answerKey: "adaptive_org_design_change_management_current_approach" },
                    { question: "Apakah ${companyName} memiliki kemampuan untuk mengelola perubahan dengan efektif?", answerKey: "adaptive_org_design_change_management_effectiveness" },
                    { question: "Apakah ada kebutuhan untuk meningkatkan kemampuan manajemen perubahan ${companyName}?", answerKey: "adaptive_org_design_change_management_improvement_needs" },
                    { question: "Bagaimana manajemen perubahan ${companyName} dibandingkan dengan pesaing utama?", answerKey: "adaptive_org_design_change_management_vs_competitors" }
                ],
                "Pengembangan Karyawan": [
                    { question: "Bagaimana ${companyName} mengembangkan karyawan saat ini?", answerKey: "adaptive_org_design_employee_development_current_programs" },
                    { question: "Apakah program pengembangan karyawan saat ini efektif di ${companyName}?", answerKey: "adaptive_org_design_employee_development_program_effectiveness" },
                    { question: "Apakah ada kebutuhan untuk meningkatkan program pengembangan karyawan agar lebih adaptif dan responsif terhadap perubahan lingkungan bisnis ${companyName}?", answerKey: "adaptive_org_design_employee_development_improvement_needs" },
                    { question: "Bagaimana pengembangan karyawan ${companyName} dibandingkan dengan pesaing utama?", answerKey: "adaptive_org_design_employee_development_vs_competitors" }
                ]
            },
            "Analisis Value Chain": {
                "Inbound Logistics (Logistik Masuk)": [
                    { question: "Bagaimana ${companyName} menerima, menyimpan, dan mendistribusikan bahan baku/input?", answerKey: "value_chain_inbound_logistics_processes" },
                    { question: "Seberapa efisien proses logistik masuk ${companyName}?", answerKey: "value_chain_inbound_logistics_efficiency" },
                    { question: "Apakah ada peluang untuk meningkatkan efisiensi dan mengurangi biaya logistik masuk ${companyName}?", answerKey: "value_chain_inbound_logistics_improvement_opportunities" },
                    { question: "Bagaimana ${companyName} memastikan kualitas bahan baku/input yang diterima?", answerKey: "value_chain_inbound_logistics_quality_assurance" },
                    { question: "Bagaimana ${companyName} mengelola hubungan dengan pemasok?", answerKey: "value_chain_inbound_logistics_supplier_relations" }
                ],
                "Operations (Operasi)": [
                    { question: "Bagaimana ${companyName} mengubah bahan baku/input menjadi produk/jasa akhir?", answerKey: "value_chain_operations_processes" },
                    { question: "Seberapa efisien proses produksi/operasi ${companyName}?", answerKey: "value_chain_operations_efficiency" },
                    { question: "Apakah ada peluang untuk meningkatkan produktivitas dan mengurangi biaya produksi di ${companyName}?", answerKey: "value_chain_operations_improvement_opportunities" },
                    { question: "Bagaimana ${companyName} memastikan kualitas produk/jasa yang dihasilkan?", answerKey: "value_chain_operations_quality_assurance" },
                    { question: "Bagaimana ${companyName} mengelola kapasitas produksi?", answerKey: "value_chain_operations_capacity_management" }
                ],
                "Outbound Logistics (Logistik Keluar)": [
                    { question: "Bagaimana ${companyName} menyimpan, mendistribusikan, dan mengirimkan produk/jasa ke pelanggan?", answerKey: "value_chain_outbound_logistics_processes" },
                    { question: "Seberapa efisien proses logistik keluar ${companyName}?", answerKey: "value_chain_outbound_logistics_efficiency" },
                    { question: "Apakah ada peluang untuk meningkatkan kecepatan dan keandalan pengiriman ${companyName}?", answerKey: "value_chain_outbound_logistics_improvement_opportunities" },
                    { question: "Bagaimana ${companyName} mengelola inventori produk jadi?", answerKey: "value_chain_outbound_logistics_inventory_management" },
                    { question: "Bagaimana ${companyName} mengelola hubungan dengan distributor dan pengecer?", answerKey: "value_chain_outbound_logistics_distributor_relations" }
                ],
                "Marketing and Sales (Pemasaran dan Penjualan)": [
                    { question: "Bagaimana ${companyName} mempromosikan dan menjual produk/jasanya?", answerKey: "value_chain_marketing_sales_promotion_sales" },
                    { question: "Seberapa efektif strategi pemasaran dan penjualan ${companyName}?", answerKey: "value_chain_marketing_sales_strategy_effectiveness" },
                    { question: "Bagaimana ${companyName} menjangkau target pasar?", answerKey: "value_chain_marketing_sales_target_market_reach" },
                    { question: "Bagaimana ${companyName} membangun merek dan citra positif?", answerKey: "value_chain_marketing_sales_brand_building" },
                    { question: "Bagaimana ${companyName} mengelola hubungan dengan pelanggan?", answerKey: "value_chain_marketing_sales_customer_relations" }
                ],
                "Service (Layanan)": [
                    { question: "Bagaimana ${companyName} memberikan layanan purna jual kepada pelanggan?", answerKey: "value_chain_service_after_sales_service" },
                    { question: "Seberapa puas pelanggan dengan layanan yang diberikan oleh ${companyName}?", answerKey: "value_chain_service_customer_satisfaction" },
                    { question: "Bagaimana ${companyName} menangani keluhan pelanggan?", answerKey: "value_chain_service_complaint_handling" },
                    { question: "Bagaimana ${companyName} membangun loyalitas pelanggan melalui layanan?", answerKey: "value_chain_service_loyalty_building" },
                    { question: "Apakah ada peluang untuk meningkatkan kualitas layanan dan menciptakan nilai tambah bagi pelanggan ${companyName}?", answerKey: "value_chain_service_improvement_opportunities" }
                ],
                "Procurement (Pengadaan) - Aktivitas Pendukung": [
                    { question: "Bagaimana ${companyName} memilih dan mengelola pemasok?", answerKey: "value_chain_procurement_supplier_selection_management" }
                ],
                "Technology Development (Pengembangan Teknologi) - Aktivitas Pendukung": [
                    { question: "Bagaimana ${companyName} mengembangkan dan menerapkan teknologi baru?", answerKey: "value_chain_tech_development_tech_innovation" }
                ],
                "Human Resource Management (Manajemen Sumber Daya Manusia) - Aktivitas Pendukung": [
                    { question: "Bagaimana ${companyName} merekrut, melatih, dan mengembangkan karyawan?", answerKey: "value_chain_hrm_employee_management" }
                ],
                "Firm Infrastructure (Infrastruktur Perusahaan) - Aktivitas Pendukung": [
                    { question: "Bagaimana ${companyName} mengelola infrastruktur dan sistem pendukung (misalnya, keuangan, hukum, IT)?", answerKey: "value_chain_firm_infrastructure_infrastructure_management" }
                ]
            },
            "Porter's 5 Forces": {
                "Ancaman Pendatang Baru": [
                    { question: "Seberapa mudah bagi perusahaan baru untuk masuk ke industri ${companyName}?", answerKey: "porters_new_entrants_ease_of_entry" },
                    { question: "Hambatan masuk apa saja yang ada (misalnya, modal awal, regulasi, akses distribusi) di industri ${companyName}?", answerKey: "porters_new_entrants_entry_barriers" },
                    { question: "Seberapa besar kemungkinan perusahaan yang sudah ada akan merespons dengan agresif terhadap pendatang baru di industri ${companyName}?", answerKey: "porters_new_entrants_incumbent_response" },
                    { question: "Apakah ada inovasi atau teknologi baru yang dapat memudahkan perusahaan baru untuk masuk ke industri ${companyName}?", answerKey: "porters_new_entrants_innovation_threat" },
                    { question: "Bagaimana ${companyName} dapat memperkuat hambatan masuk dan mempertahankan posisi pasarnya?", answerKey: "porters_new_entrants_strengthen_barriers" }
                ],
                "Daya Tawar Pemasok": [
                    { question: "Seberapa terkonsentrasi industri pemasok ${companyName}?", answerKey: "porters_supplier_power_supplier_concentration" },
                    { question: "Seberapa penting input yang disediakan oleh pemasok bagi ${companyName}?", answerKey: "porters_supplier_power_input_importance" },
                    { question: "Apakah ada alternatif pemasok yang tersedia untuk ${companyName}?", answerKey: "porters_supplier_power_supplier_alternatives" },
                    { question: "Seberapa mudah bagi ${companyName} untuk beralih ke pemasok lain?", answerKey: "porters_supplier_power_switching_cost" },
                    { question: "Seberapa besar pengaruh pemasok terhadap harga dan kualitas produk/jasa ${companyName}?", answerKey: "porters_supplier_power_price_quality_impact" },
                    { question: "Bagaimana ${companyName} dapat membangun hubungan yang kuat dengan pemasok dan mengurangi ketergantungan pada satu pemasok?", answerKey: "porters_supplier_power_supplier_relations" }
                ],
                "Daya Tawar Pembeli": [
                    { question: "Seberapa terkonsentrasi industri pembeli ${companyName}?", answerKey: "porters_buyer_power_buyer_concentration" },
                    { question: "Seberapa penting produk/jasa ${companyName} bagi pembeli?", answerKey: "porters_buyer_power_product_importance_to_buyer" },
                    { question: "Apakah ada alternatif produk/jasa yang tersedia bagi pembeli ${companyName}?", answerKey: "porters_buyer_power_buyer_alternatives" },
                    { question: "Seberapa mudah bagi pembeli untuk beralih ke produk/jasa lain selain dari ${companyName}?", answerKey: "porters_buyer_power_buyer_switching_cost" },
                    { question: "Seberapa sensitif pembeli terhadap harga produk/jasa ${companyName}?", answerKey: "porters_buyer_power_price_sensitivity" },
                    { question: "Bagaimana ${companyName} dapat meningkatkan nilai produk/jasanya bagi pembeli dan membangun loyalitas pelanggan?", answerKey: "porters_buyer_power_increase_buyer_value" }
                ],
                "Ancaman Produk/Jasa Pengganti": [
                    { question: "Apakah ada produk/jasa pengganti yang tersedia di pasar untuk produk/jasa ${companyName}?", answerKey: "porters_substitute_threat_substitute_availability" },
                    { question: "Seberapa besar ancaman dari produk/jasa pengganti tersebut bagi ${companyName}?", answerKey: "porters_substitute_threat_substitute_threat_level" },
                    { question: "Seberapa mudah bagi pelanggan untuk beralih ke produk/jasa pengganti dari produk/jasa ${companyName}?", answerKey: "porters_substitute_threat_substitute_switching_cost" },
                    { question: "Apa keunggulan dan kelemahan produk/jasa pengganti dibandingkan dengan produk/jasa ${companyName}?", answerKey: "porters_substitute_threat_substitute_advantages_disadvantages" },
                    { question: "Bagaimana ${companyName} dapat membedakan produk/jasanya dan mengurangi ancaman dari produk/jasa pengganti?", answerKey: "porters_substitute_threat_differentiate_product" }
                ],
                "Persaingan di antara Perusahaan yang Sudah Ada": [
                    { question: "Seberapa intens persaingan di antara perusahaan yang sudah ada di industri ${companyName}?", answerKey: "porters_industry_rivalry_rivalry_intensity" },
                    { question: "Faktor-faktor apa saja yang mendorong persaingan (misalnya, pertumbuhan industri, diferensiasi produk, hambatan keluar) di industri ${companyName}?", answerKey: "porters_industry_rivalry_rivalry_drivers" },
                    { question: "Bagaimana strategi ${companyName} dibandingkan dengan pesaing utamanya?", answerKey: "porters_industry_rivalry_company_strategy_vs_competitors" },
                    { question: "Apa keunggulan kompetitif ${companyName}?", answerKey: "porters_industry_rivalry_competitive_advantage" },
                    { question: "Bagaimana ${companyName} dapat memperkuat keunggulan kompetitifnya dan memenangkan persaingan?", answerKey: "porters_industry_rivalry_strengthen_advantage" }
                ]
            },
            "Analisis SWOT": {
                "Strengths (Kekuatan)": [
                    { question: "Apa saja keunggulan kompetitif utama ${companyName}?", answerKey: "swot_strengths_core_competencies" },
                    { question: "Sumber daya dan kapabilitas unik apa saja yang dimiliki ${companyName}?", answerKey: "swot_strengths_unique_resources" },
                    { question: "Hal-hal apa saja yang dilakukan ${companyName} dengan sangat baik?", answerKey: "swot_strengths_company_achievements" },
                    { question: "Bagaimana ${companyName} dapat memanfaatkan kekuatan-kekuatan ini untuk mencapai tujuan strategisnya?", answerKey: "swot_strengths_leverage_strengths" },
                    { question: "Bagaimana kekuatan-kekuatan ${companyName} dibandingkan dengan pesaing utama?", answerKey: "swot_strengths_strengths_vs_competitors" }
                ],
                "Weaknesses (Kelemahan)": [
                    { question: "Apa saja kelemahan internal ${companyName}?", answerKey: "swot_weaknesses_internal_weaknesses" },
                    { question: "Keterbatasan internal apa saja yang dimiliki ${companyName}?", answerKey: "swot_weaknesses_internal_limitations" },
                    { question: "Area mana saja yang perlu ditingkatkan kinerjanya di ${companyName}?", answerKey: "swot_weaknesses_improvement_areas" },
                    { question: "Faktor-faktor apa saja yang menghambat ${companyName} dalam mencapai tujuannya?", answerKey: "swot_weaknesses_hindering_factors" },
                    { question: "Bagaimana ${companyName} dapat mengatasi kelemahan-kelemahan ini?", answerKey: "swot_weaknesses_overcome_weaknesses" },
                    { question: "Bagaimana kelemahan-kelemahan ${companyName} dibandingkan dengan pesaing utama?", answerKey: "swot_weaknesses_weaknesses_vs_competitors" }
                ],
                "Opportunities (Peluang)": [
                    { question: "Tren eksternal apa saja yang dapat dimanfaatkan oleh ${companyName}?", answerKey: "swot_opportunities_external_trends" },
                    { question: "Peluang eksternal apa saja yang dapat dimanfaatkan oleh ${companyName}?", answerKey: "swot_opportunities_external_opportunities" },
                    { question: "Perubahan lingkungan bisnis apa saja yang dapat menciptakan peluang baru bagi ${companyName}?", answerKey: "swot_opportunities_environmental_changes" },
                    { question: "Segmen pasar baru mana saja yang dapat dimasuki oleh ${companyName}?", answerKey: "swot_opportunities_new_market_segments" },
                    { question: "Bagaimana ${companyName} dapat memanfaatkan peluang-peluang ini untuk mencapai pertumbuhan dan kesuksesan?", answerKey: "swot_opportunities_leverage_opportunities" },
                    { question: "Bagaimana peluang-peluang ini dibandingkan dengan pesaing utama ${companyName}?", answerKey: "swot_opportunities_opportunities_vs_competitors" }
                ],
                "Threats (Ancaman)": [
                    { question: "Ancaman eksternal apa saja yang dihadapi oleh ${companyName}?", answerKey: "swot_threats_external_threats" },
                    { question: "Tantangan eksternal apa saja yang dihadapi oleh ${companyName}?", answerKey: "swot_threats_external_challenges" },
                    { question: "Perubahan lingkungan bisnis apa saja yang dapat mengancam ${companyName}?", answerKey: "swot_threats_environmental_threats" },
                    { question: "Risiko apa saja yang perlu diwaspadai oleh ${companyName}?", answerKey: "swot_threats_potential_risks" },
                    { question: "Bagaimana ${companyName} dapat mengatasi ancaman-ancaman ini?", answerKey: "swot_threats_mitigate_threats" },
                    { question: "Bagaimana ancaman-ancaman ini dibandingkan dengan pesaing utama ${companyName}?", answerKey: "swot_threats_threats_vs_competitors" }
                ]
            },
            "Analisis Skenario": {
                "Faktor-faktor Ketidakpastian": [
                    { question: "Faktor eksternal apa saja yang paling tidak pasti dan dapat mempengaruhi ${companyName} secara signifikan?", answerKey: "scenario_analysis_uncertainties_key_uncertainties" },
                    { question: "Bagaimana tingkat ketidakpastian dari masing-masing faktor tersebut bagi ${companyName}?", answerKey: "scenario_analysis_uncertainties_uncertainty_level" },
                    { question: "Kemungkinan perkembangan apa saja dari faktor-faktor tersebut di masa depan untuk ${companyName}?", answerKey: "scenario_analysis_uncertainties_future_developments" },
                    { question: "Bagaimana ${companyName} dapat memantau dan mengantisipasi perubahan dalam faktor-faktor tersebut?", answerKey: "scenario_analysis_uncertainties_monitor_anticipate_changes" }
                ],
                "Tren Utama": [
                    { question: "Tren utama apa saja yang sedang terjadi di industri dan lingkungan bisnis secara umum yang relevan dengan ${companyName}?", answerKey: "scenario_analysis_key_trends_current_trends" },
                    { question: "Bagaimana tren tersebut dapat mempengaruhi ${companyName} di masa depan?", answerKey: "scenario_analysis_key_trends_trend_impact" },
                    { question: "Apakah ada tren yang baru muncul atau yang diperkirakan akan muncul di masa depan yang perlu diperhatikan oleh ${companyName}?", answerKey: "scenario_analysis_key_trends_emerging_trends" },
                    { question: "Bagaimana ${companyName} dapat memanfaatkan tren tersebut untuk menciptakan peluang baru?", answerKey: "scenario_analysis_key_trends_leverage_trends" }
                ],
                "Potensi Disrupsi": [
                    { question: "Potensi disrupsi apa saja yang dapat terjadi di industri ${companyName} (misalnya, teknologi baru, perubahan regulasi, perubahan perilaku konsumen)?", answerKey: "scenario_analysis_potential_disruptions_potential_disruptions" },
                    { question: "Seberapa besar kemungkinan disrupsi tersebut terjadi di industri ${companyName}?", answerKey: "scenario_analysis_potential_disruptions_disruption_likelihood" },
                    { question: "Apa dampak potensial dari disrupsi tersebut terhadap ${companyName}?", answerKey: "scenario_analysis_potential_disruptions_disruption_impact" },
                    { question: "Bagaimana ${companyName} dapat mengantisipasi dan merespons disrupsi tersebut?", answerKey: "scenario_analysis_potential_disruptions_disruption_response" }
                ],
                "Skenario Alternatif": [
                    { question: "Skenario alternatif 1: Deskripsi singkat?", answerKey: "scenario_analysis_alternative_scenarios_scenario_1_description" },
                    { question: "Skenario alternatif 2: Deskripsi singkat?", answerKey: "scenario_analysis_alternative_scenarios_scenario_2_description" },
                    { question: "Skenario alternatif 3: Deskripsi singkat?", answerKey: "scenario_analysis_alternative_scenarios_scenario_3_description" },
                    { question: "Bagaimana kondisi bisnis dan lingkungan persaingan dalam skenario 1 untuk ${companyName}?", answerKey: "scenario_analysis_alternative_scenarios_scenario_1_business_conditions" },
                    { question: "Bagaimana kondisi bisnis dan lingkungan persaingan dalam skenario 2 untuk ${companyName}?", answerKey: "scenario_analysis_alternative_scenarios_scenario_2_business_conditions" },
                    { question: "Bagaimana kondisi bisnis dan lingkungan persaingan dalam skenario 3 untuk ${companyName}?", answerKey: "scenario_analysis_alternative_scenarios_scenario_3_business_conditions" },
                    { question: "Apa implikasi dari skenario 1 terhadap strategi dan operasional ${companyName}?", answerKey: "scenario_analysis_alternative_scenarios_scenario_1_strategic_implications" },
                    { question: "Apa implikasi dari skenario 2 terhadap strategi dan operasional ${companyName}?", answerKey: "scenario_analysis_alternative_scenarios_scenario_2_strategic_implications" },
                    { question: "Apa implikasi dari skenario 3 terhadap strategi dan operasional ${companyName}?", answerKey: "scenario_analysis_alternative_scenarios_scenario_3_strategic_implications" }
                ],
                "Strategi Adaptif": [
                    { question: "Bagaimana ${companyName} dapat mengembangkan strategi yang fleksibel dan adaptif untuk menghadapi berbagai skenario yang mungkin terjadi?", answerKey: "scenario_analysis_adaptive_strategy_develop_adaptive_strategy" },
                    { question: "Opsi strategis apa saja yang tersedia bagi ${companyName} dalam setiap skenario?", answerKey: "scenario_analysis_adaptive_strategy_strategic_options" },
                    { question: "Bagaimana ${companyName} dapat mempersiapkan diri untuk menghadapi perubahan dan ketidakpastian?", answerKey: "scenario_analysis_adaptive_strategy_prepare_for_uncertainty" }
                ]
            },
            "Analisis PESTEL": {
                "Politik": [
                    { question: "Bagaimana stabilitas politik di negara tempat ${companyName} beroperasi?", answerKey: "pestel_political_stability" },
                    { question: "Perubahan kebijakan pemerintah apa saja yang dapat mempengaruhi industri dan ${companyName} (misalnya, perpajakan, regulasi, kebijakan perdagangan)?", answerKey: "pestel_government_policy_changes" },
                    { question: "Risiko politik apa saja yang perlu dipertimbangkan oleh ${companyName} (misalnya, korupsi, ketidakstabilan sosial)?", answerKey: "pestel_political_risks" },
                    { question: "Bagaimana ${companyName} dapat membangun hubungan yang baik dengan pemerintah dan stakeholder politik?", answerKey: "pestel_government_relations" }
                ],
                "Ekonomi": [
                    { question: "Bagaimana kondisi ekonomi makro saat ini dan di masa depan (misalnya, pertumbuhan ekonomi, inflasi, suku bunga, nilai tukar) yang mempengaruhi ${companyName}?", answerKey: "pestel_economic_conditions" },
                    { question: "Bagaimana tren ekonomi tersebut dapat mempengaruhi daya beli konsumen dan permintaan terhadap produk/jasa ${companyName}?", answerKey: "pestel_economic_trends_consumer_impact" },
                    { question: "Faktor ekonomi global apa saja yang dapat mempengaruhi ${companyName} (misalnya, krisis ekonomi global, perubahan harga komoditas)?", answerKey: "pestel_global_economic_factors" },
                    { question: "Bagaimana ${companyName} dapat mengelola risiko ekonomi dan memanfaatkan peluang ekonomi?", answerKey: "pestel_economic_risk_management" }
                ],
                "Sosial": [
                    { question: "Bagaimana tren demografi (misalnya, pertumbuhan penduduk, usia, distribusi pendapatan) dapat mempengaruhi ${companyName}?", answerKey: "pestel_demographic_trends" },
                    { question: "Bagaimana perubahan gaya hidup, nilai-nilai sosial, dan budaya masyarakat dapat mempengaruhi ${companyName}?", answerKey: "pestel_social_cultural_changes" },
                    { question: "Bagaimana tren sosial tersebut dapat mempengaruhi preferensi konsumen dan permintaan terhadap produk/jasa ${companyName}?", answerKey: "pestel_social_trends_consumer_preference_impact" },
                    { question: "Bagaimana ${companyName} dapat menyesuaikan produk/jasanya dengan perubahan sosial dan budaya?", answerKey: "pestel_social_cultural_adaptation" }
                ],
                "Teknologi": [
                    { question: "Perkembangan teknologi terbaru apa saja yang relevan dengan industri dan ${companyName}?", answerKey: "pestel_technological_advancements" },
                    { question: "Bagaimana teknologi dapat mempengaruhi proses produksi, distribusi, pemasaran, dan layanan pelanggan ${companyName}?", answerKey: "pestel_technology_impact_business_processes" },
                    { question: "Apakah ada potensi disrupsi teknologi yang dapat mengancam ${companyName}?", answerKey: "pestel_technological_disruptions" },
                    { question: "Bagaimana ${companyName} dapat memanfaatkan teknologi untuk meningkatkan efisiensi, inovasi, dan keunggulan kompetitif?", answerKey: "pestel_technology_leverage_competitive_advantage" }
                ],
                "Lingkungan": [
                    { question: "Isu lingkungan apa saja yang relevan dengan industri dan ${companyName} (misalnya, perubahan iklim, polusi, kelangkaan sumber daya)?", answerKey: "pestel_environmental_issues" },
                    { question: "Bagaimana regulasi lingkungan dan kesadaran masyarakat terhadap isu lingkungan dapat mempengaruhi ${companyName}?", answerKey: "pestel_environmental_regulations_awareness" },
                    { question: "Bagaimana ${companyName} dapat mengurangi dampak negatif terhadap lingkungan?", answerKey: "pestel_environmental_impact_reduction" },
                    { question: "Bagaimana ${companyName} dapat menerapkan praktik bisnis yang berkelanjutan?", answerKey: "pestel_sustainability_practices" }
                ],
                "Hukum": [
                    { question: "Peraturan perundang-undangan apa saja yang relevan dengan industri dan ${companyName} (misalnya, hukum ketenagakerjaan, hukum perlindungan konsumen, hukum persaingan usaha)?", answerKey: "pestel_legal_regulations_relevant_laws_combined" },
                    { question: "Apakah ada hukum ketenagakerjaan yang kiranya relevan dengan industri dan ${companyName}?", answerKey: "pestel_legal_regulations_labor_law" },
                    { question: "Apakah ada hukum perlindungan konsumen yang kiranya relevan dengan ${companyName} dan industri?", answerKey: "pestel_legal_regulations_consumer_protection_law" },
                    { question: "Apakah ada hukum persaingan usaha yang kiranya relevan dengan industri dan ${companyName}?", answerKey: "pestel_legal_regulations_competition_law" },
                    { question: "Apa ada hukum dan peraturan perundang-undangan lain yang kiranya relevan dengan industri dan ${companyName}?", answerKey: "pestel_legal_regulations_other_relevant_laws" },
                    { question: "Apakah ada perubahan regulasi yang akan datang atau yang sedang diusulkan yang perlu diperhatikan oleh ${companyName}?", answerKey: "pestel_legal_regulations_upcoming_changes" },
                    { question: "Bagaimana ${companyName} dapat memastikan kepatuhan terhadap hukum dan regulasi?", answerKey: "pestel_legal_regulations_compliance" }
                ]
            },
            "Penggunaan Data dan Analitik": {
                "Pengumpulan Data": [
                    { question: "Data apa saja yang dikumpulkan ${companyName} saat ini?", answerKey: "data_analytics_data_collection_current_data" },
                    { question: "Bagaimana ${companyName} mengumpulkan data dari berbagai sumber?", answerKey: "data_analytics_data_collection_data_sources" },
                    { question: "Apakah data yang dikumpulkan relevan dengan kebutuhan bisnis ${companyName}?", answerKey: "data_analytics_data_collection_data_relevance" },
                    { question: "Apakah data yang dikumpulkan berkualitas tinggi dan akurat di ${companyName}?", answerKey: "data_analytics_data_collection_data_quality" }
                ],
                "Penyimpanan dan Pengelolaan Data": [
                    { question: "Bagaimana ${companyName} menyimpan dan mengelola data?", answerKey: "data_analytics_data_management_data_storage" },
                    { question: "Apakah ${companyName} memiliki infrastruktur penyimpanan data yang memadai?", answerKey: "data_analytics_data_management_infrastructure" },
                    { question: "Apakah data ${companyName} aman dan terlindungi dari akses yang tidak sah?", answerKey: "data_analytics_data_management_data_security" },
                    { question: "Apakah data ${companyName} mudah diakses dan digunakan oleh pihak yang berwenang?", answerKey: "data_analytics_data_management_data_accessibility" }
                ],
                "Analisis Data": [
                    { question: "Bagaimana ${companyName} menganalisis data untuk mendukung pengambilan keputusan bisnis?", answerKey: "data_analytics_data_analysis_business_decisions" },
                    { question: "Apakah ${companyName} memiliki kemampuan analitik yang memadai?", answerKey: "data_analytics_data_analysis_analytical_capabilities" },
                    { question: "Apakah ${companyName} menggunakan alat dan teknik analitik yang tepat?", answerKey: "data_analytics_data_analysis_analytical_tools" },
                    { question: "Apakah ${companyName} memanfaatkan data untuk mengidentifikasi tren dan peluang bisnis?", answerKey: "data_analytics_data_analysis_trend_identification" }
                ],
                "Visualisasi Data": [
                    { question: "Bagaimana ${companyName} memvisualisasikan data untuk memudahkan pemahaman dan komunikasi?", answerKey: "data_analytics_data_visualization_communication" },
                    { question: "Apakah ${companyName} menggunakan alat visualisasi data yang efektif?", answerKey: "data_analytics_data_visualization_tools_effectiveness" },
                    { question: "Apakah visualisasi data ${companyName} mudah dipahami dan informatif?", answerKey: "data_analytics_data_visualization_clarity_informativeness" },
                    { question: "Apakah visualisasi data ${companyName} mendukung pengambilan keputusan yang lebih baik?", answerKey: "data_analytics_data_visualization_decision_support" }
                ],
                "Pemanfaatan Data dalam Pengambilan Keputusan": [
                    { question: "Bagaimana ${companyName} memanfaatkan data dalam pengambilan keputusan strategis dan operasional?", answerKey: "data_analytics_data_utilization_strategic_operational_decisions" },
                    { question: "Apakah data digunakan untuk mengukur kinerja bisnis dan mengidentifikasi area yang perlu ditingkatkan di ${companyName}?", answerKey: "data_analytics_data_utilization_performance_measurement" },
                    { question: "Apakah data digunakan untuk mengembangkan strategi bisnis yang lebih efektif di ${companyName}?", answerKey: "data_analytics_data_utilization_strategy_development" },
                    { question: "Apakah data digunakan untuk mengidentifikasi dan mengelola risiko bisnis di ${companyName}?", answerKey: "data_analytics_data_utilization_risk_management" }
                ],
                "Budaya Data": [
                    { question: "Apakah ${companyName} memiliki budaya data yang kuat?", answerKey: "data_analytics_data_culture_data_driven_culture" },
                    { question: "Apakah karyawan ${companyName} memahami pentingnya data dan analitik?", answerKey: "data_analytics_data_culture_employee_awareness" },
                    { question: "Apakah karyawan ${companyName} memiliki kemampuan untuk menggunakan data dan analitik dalam pekerjaan mereka?", answerKey: "data_analytics_data_culture_employee_skills" },
                    { question: "Apakah ${companyName} mendorong kolaborasi dan berbagi pengetahuan terkait data?", answerKey: "data_analytics_data_culture_data_sharing_collaboration" }
                ]
            },
            "Keberlanjutan (Sustainability)": {
                "Dampak Lingkungan": [
                    { question: "Apa saja dampak lingkungan dari operasional bisnis ${companyName}?", answerKey: "sustainability_environmental_impact_business_operations" },
                    { question: "Bagaimana ${companyName} mengelola limbah dan emisi?", answerKey: "sustainability_environmental_impact_waste_emission_management" },
                    { question: "Apakah ${companyName} menggunakan sumber daya alam secara efisien?", answerKey: "sustainability_environmental_impact_resource_efficiency" },
                    { question: "Bagaimana ${companyName} berkontribusi terhadap perubahan iklim?", answerKey: "sustainability_environmental_impact_climate_change_contribution" },
                    { question: "Apakah ada regulasi lingkungan yang relevan dengan bisnis ${companyName}?", answerKey: "sustainability_environmental_impact_environmental_regulations" }
                ],
                "Tanggung Jawab Sosial": [
                    { question: "Bagaimana ${companyName} berkontribusi terhadap masyarakat?", answerKey: "sustainability_social_responsibility_community_contribution" },
                    { question: "Bagaimana ${companyName} memperlakukan karyawan?", answerKey: "sustainability_social_responsibility_employee_treatment" },
                    { question: "Bagaimana ${companyName} memperlakukan komunitas lokal di sekitar perusahaan?", answerKey: "sustainability_social_responsibility_local_community_treatment" },
                    { question: "Apakah ${companyName} memiliki kebijakan dan program tanggung jawab sosial yang efektif?", answerKey: "sustainability_social_responsibility_csr_programs" },
                    { question: "Bagaimana ${companyName} membangun hubungan yang baik dengan pemangku kepentingan?", answerKey: "sustainability_social_responsibility_stakeholder_relations" }
                ],
                "Tata Kelola Perusahaan": [
                    { question: "Bagaimana struktur tata kelola perusahaan ${companyName}?", answerKey: "sustainability_corporate_governance_governance_structure" },
                    { question: "Apakah ${companyName} memiliki kebijakan dan prosedur tata kelola yang transparan?", answerKey: "sustainability_corporate_governance_transparency_policies" },
                    { question: "Apakah ${companyName} memiliki kebijakan dan prosedur tata kelola yang akuntabel?", answerKey: "sustainability_corporate_governance_accountability_policies" },
                    { question: "Bagaimana ${companyName} mengelola risiko dan kepatuhan?", answerKey: "sustainability_corporate_governance_risk_compliance_management" },
                    { question: "Apakah ${companyName} memiliki budaya etika yang kuat?", answerKey: "sustainability_corporate_governance_ethical_culture" }
                ],
                "Integrasi ESG dalam Strategi Bisnis": [
                    { question: "Bagaimana ${companyName} mengintegrasikan aspek Lingkungan (Environmental) dalam strategi bisnisnya?", answerKey: "sustainability_esg_integration_environmental_integration" },
                    { question: "Bagaimana ${companyName} mengintegrasikan aspek Sosial (Social) dalam strategi bisnisnya?", answerKey: "sustainability_esg_integration_social_integration" },
                    { question: "Bagaimana ${companyName} mengintegrasikan aspek Tata Kelola (Governance) dalam strategi bisnisnya?", answerKey: "sustainability_esg_integration_governance_integration" },
                    { question: "Bagaimana ${companyName} secara keseluruhan mengintegrasikan aspek ESG ke dalam strategi bisnisnya?", answerKey: "sustainability_esg_integration_overall_esg_integration" },
                    { question: "Apakah ${companyName} memiliki target kinerja ESG yang terukur?", answerKey: "sustainability_esg_integration_measurable_esg_targets" },
                    { question: "Apakah ${companyName} memiliki indikator kinerja ESG yang terukur?", answerKey: "sustainability_esg_integration_measurable_esg_indicators" },
                    { question: "Bagaimana ${companyName} mengkomunikasikan kinerja ESG kepada pemangku kepentingan?", answerKey: "sustainability_esg_integration_esg_communication" },
                    { question: "Bagaimana ${companyName} mengukur dampak ESG terhadap kinerja keuangan?", answerKey: "sustainability_esg_integration_esg_financial_impact" }
                ],
                "Inovasi Berkelanjutan": [
                    { question: "Bagaimana ${companyName} mendorong inovasi berkelanjutan?", answerKey: "sustainability_sustainable_innovation_foster_innovation" },
                    { question: "Apakah ${companyName} mengembangkan produk dan layanan yang ramah lingkungan?", answerKey: "sustainability_sustainable_innovation_eco_friendly_products" },
                    { question: "Apakah ${companyName} mengembangkan produk dan layanan yang ramah sosial?", answerKey: "sustainability_sustainable_innovation_socially_responsible_products" },
                    { question: "Apakah ${companyName} berinvestasi dalam teknologi dan praktik bisnis yang berkelanjutan?", answerKey: "sustainability_sustainable_innovation_investment_sustainable_tech" },
                    { question: "Bagaimana ${companyName} berkolaborasi dengan pemangku kepentingan untuk menciptakan solusi berkelanjutan?", answerKey: "sustainability_sustainable_innovation_stakeholder_collaboration" }
                ]
            }
        };
    </script>

    <script>
        const analysisCompletionSection = document.getElementById('analysis-completion-section');
        const checkpointSection = document.getElementById('checkpoint-section');
        const topicCheckpointSection = document.getElementById('topic-checkpoint-section'); // NEW
        const topicGreetingSection = document.getElementById('topic-greeting-section'); // NEW
        const userInfoFormSection = document.getElementById('user-info-form-section');
        const userInfoForm = document.getElementById('user-info-form');
        const questionSection = document.getElementById('question-section');
        const questionCard = document.getElementById('question-card');
        const cardAnalysisTitle = document.getElementById('card-analysis-title');
        const cardTopicTitle = document.getElementById('card-topic-title');
        const cardQuestionText = document.getElementById('card-question-text');
        const answerTextarea = document.getElementById('answer-textarea');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn-question');
        const questionNumberDisplay = document.getElementById('question-number');
        const progressBarFill = document.getElementById('progress-fill');
        const progressBarSegments = document.getElementById('progress-segments');
        const reportSection = document.getElementById('report-section');
        const reportUserInfoDiv = document.getElementById('report-user-info');
        const reportAnswersDiv = document.getElementById('report-answers');

        // NEW BUTTONS & ELEMENTS
        const topicCheckpointAnalysisNameDisplay = document.getElementById('topic-checkpoint-analysis-name');
        const topicCheckpointCardsContainer = document.getElementById('topic-checkpoint-cards-container');
        const goToMainCheckpointBtn_TopicCheckpoint = document.getElementById('go-to-main-checkpoint-btn');
        const goToTopicCheckpointBtn_Greeting = document.getElementById('go-to-topic-checkpoint-btn');
        const goToMainCheckpointBtn_Greeting = document.getElementById('go-to-main-checkpoint-btn');
        const startTopicBtn = document.getElementById('start-topic-btn');
        const nextTopicBtn = document.getElementById('next-topic-btn');
        const topicGreetingTitle = document.getElementById('topic-greeting-title');
        const topicGreetingDescription = document.getElementById('topic-greeting-description');


        let currentAnalysisKeys = Object.keys(questionsData);
        let currentAnalysisIndex = 0;
        let currentTopicKeys;
        let currentTopicIndex = 0;
        let currentQuestionIndex = 0;
        let currentQuestions;


        let userData = {
            fullName: "",
            companyName: "",
            position: "",
            industry: "",
            productService: "",
            companySize: ""
        };
        let answers = {};


        // --- Local Storage Functions ---
        function loadUserData() {
            const storedUserData = localStorage.getItem('rjppUserData');
            if (storedUserData) {
                userData = JSON.parse(storedUserData);
                document.getElementById('fullName').value = userData.fullName || "";
                document.getElementById('companyName').value = userData.companyName || "";
                document.getElementById('position').value = userData.position || "";
                document.getElementById('industry').value = userData.industry || "";
                document.getElementById('productService').value = userData.productService || "";
                document.getElementById('companySize').value = userData.companySize || "";
            }
        }

        function saveUserData() {
            localStorage.setItem('rjppUserData', JSON.stringify(userData));
        }

        function loadAnswers() {
            const storedAnswers = localStorage.getItem('rjppAnswers');
            if (storedAnswers) {
                try {
                    const storedState = JSON.parse(storedAnswers);
                    if (storedState && storedState.answers) {
                        answers = storedState.answers;
                        currentAnalysisIndex = storedState.currentAnalysisIndex || 0;
                        currentTopicIndex = storedState.currentTopicIndex || 0;
                        currentQuestionIndex = storedState.currentQuestionIndex || 0;
                        currentAnalysisKeys = storedState.currentAnalysisKeys || Object.keys(questionsData);
                        currentTopicKeys = storedState.currentTopicKeys || Object.keys(questionsData[currentAnalysisKeys[currentAnalysisIndex]]);
                        currentQuestions = questionsData[currentAnalysisKeys[currentAnalysisIndex]][currentTopicKeys[currentTopicIndex]] || [];
                        currentTopicIndex = storedState.currentTopicIndex || 0;
        
                        // --- NEW LOGIC: Find first unanswered question based on status ---
                        let foundUnanswered = false;
                        for (let analysisIndex = 0; analysisIndex < currentAnalysisKeys.length; analysisIndex++) {
                            const analysisKey = currentAnalysisKeys[analysisIndex];
                            const topicKeys = Object.keys(questionsData[analysisKey]);
                            for (let topicIndex = 0; topicIndex < topicKeys.length; topicIndex++) {
                                const topicKey = topicKeys[topicIndex];
                                const topicData = questionsData[analysisKey][topicKey];
                                const topicStatus = answers[analysisKey]?.[topicKey]?.status || "not-started"; // Default to "not-started" if no status
        
                                if (topicStatus !== "completed") { // Only look for unanswered if topic is not completed
                                    for (let questionIndex = 0; questionIndex < topicData.length; questionIndex++) {
                                        const question = topicData[questionIndex];
                                        if (!answers[analysisKey]?.[topicKey]?.answers?.[question.answerKey]) { // Nested check
                                            currentAnalysisIndex = analysisIndex;
                                            currentTopicIndex = topicIndex;
                                            currentQuestionIndex = questionIndex;
                                            currentTopicKeys = Object.keys(questionsData[currentAnalysisKeys[currentAnalysisIndex]]);
                                            currentQuestions = questionsData[currentAnalysisKeys[currentAnalysisIndex]][currentTopicKeys[currentTopicIndex]];
                                            foundUnanswered = true;
                                            break; // Found first unanswered, break inner loop
                                        }
                                    }
                                }
                                if (foundUnanswered) break; // Break topic loop if unanswered found
                            }
                            if (foundUnanswered) break; // Break analysis loop if unanswered found
                        }
                        if (!foundUnanswered) {
                            // All questions answered, go to report (or last question)
                            currentAnalysisIndex = currentAnalysisKeys.length - 1;
                            currentTopicKeys = Object.keys(questionsData[currentAnalysisKeys[currentAnalysisIndex]]);
                            currentTopicIndex = currentTopicKeys.length - 1;
                            currentQuestions = questionsData[currentAnalysisKeys[currentAnalysisIndex]][currentTopicKeys[currentTopicKeys[currentTopicIndex]]];
                            currentQuestionIndex = currentQuestions.length - 1;
                        }
                        // --- End NEW LOGIC ---
        
        
                    } else {
                        answers = {}; // Reset if no valid answers in stored state
                    }
                } catch (e) {
                    console.error("Error parsing stored answers, resetting:", e);
                    answers = {}; // Reset if parsing error
                    localStorage.removeItem('rjppAnswers'); // Optionally clear corrupted data
                }
            } else {
                answers = {}; // Initialize as empty if no stored answers found
            }
            console.log("loadAnswers - answers object loaded from localStorage:", answers);
        }

        function saveAnswers() {
            const stateToSave = {
                answers: answers,
                currentAnalysisIndex: currentAnalysisIndex,
                currentTopicIndex: currentTopicIndex, // Save topic index
                currentQuestionIndex: currentQuestionIndex,
                currentAnalysisKeys: currentAnalysisKeys,
                currentTopicKeys: currentTopicKeys
            };
            localStorage.setItem('rjppAnswers', JSON.stringify(stateToSave));
            console.log("saveAnswers - answers object saved to localStorage:", stateToSave);
        }

        function clearLocalStorageData() {
            localStorage.removeItem('rjppUserData');
            localStorage.removeItem('rjppAnswers');
        }

        const clearDataBtn = document.getElementById('clear-data-btn');

        clearDataBtn.addEventListener('click', function() {
            const confirmClear = window.confirm("⚠️ Are you sure you want to remove all saved data?\n\nThis will delete all your answers and progress. This action cannot be undone.");
            if (confirmClear) {
                clearLocalStorageData();
                alert("✅ All data has been removed. You will be redirected to the start.");

                // Reset UI to initial state:
                userInfoFormSection.style.display = 'block';
                checkpointSection.style.display = 'none';
                topicCheckpointSection.style.display = 'none'; // Hide topic checkpoint too
                topicGreetingSection.style.display = 'none'; // Hide topic greeting too
                questionSection.style.display = 'none';
                reportSection.style.display = 'none';

                // Clear input field & reload the page for a full reset (more thorough)
                document.getElementById('user-info-form').reset();
                window.location.reload();

            }
        });

        // --- Function to Initialize and Display Questions ---
        function startAnalysis() {
            userInfoFormSection.style.display = 'none';
            checkpointSection.style.display = 'block';
            topicCheckpointSection.style.display = 'none'; // Ensure topic checkpoint is hidden
            topicGreetingSection.style.display = 'none'; // Ensure topic greeting is hidden
            questionSection.style.display = 'none';
            reportSection.style.display = 'none';
            saveUserData();
            loadAnswers();
            displayCheckpointPage();
        }

        function displayCheckpointPage() {
            analysisCompletionSection.style.display = 'none';
            checkpointSection.style.display = 'block';
            topicCheckpointSection.style.display = 'none';
            topicGreetingSection.style.display = 'none';
            questionSection.style.display = 'none';
            reportSection.style.display = 'none';
        
            const cardsContainer = document.getElementById('checkpoint-cards-container');
            cardsContainer.innerHTML = '';

            let allAnalysesCompleted = true;

            for (const analysisKey of currentAnalysisKeys) {
                const analysisData = questionsData[analysisKey];
                let analysisStatus = 'not-answered'; // Default analysis status
                let allTopicsCompleted = true;
                let partiallyAnsweredTopics = false;
                let noTopicsAnsweredYet = true; // Flag to check if ANY topic in analysis has been started

                console.groupCollapsed(`Analysis: ${analysisKey}`); // Start console group for analysis

                for (const topicKey in analysisData) {
                    const topicStatus = answers[analysisKey]?.[topicKey]?.status || "not-started";
                    console.log(`  Topic: ${topicKey}, Status: ${topicStatus}`); // Log topic status

                    if (topicStatus === 'completed') {
                        noTopicsAnsweredYet = false; // At least one topic is answered
                    } else if (topicStatus === 'in-progress') {
                        partiallyAnsweredTopics = true; // Still partially answered because of in-progress topic
                        allTopicsCompleted = false;
                        noTopicsAnsweredYet = false; // At least one topic is started
                    } else { // topicStatus is 'not-started'
                        allTopicsCompleted = false;
                        // partiallyAnsweredTopics remains false if no topic is in-progress yet
                    }
                    if (topicStatus === 'completed' || topicStatus === 'in-progress') { // Modified condition: if ANY topic is completed or in-progress
                        partiallyAnsweredTopics = true; // Then the analysis is at least partially answered
                    }
                }

                console.log(`  allTopicsCompleted: ${allTopicsCompleted}, partiallyAnsweredTopics: ${partiallyAnsweredTopics}, noTopicsAnsweredYet: ${noTopicsAnsweredYet}`); // Log status flags

                if (allTopicsCompleted && Object.keys(analysisData).length > 0) {
                    analysisStatus = 'answered';
                } else if (partiallyAnsweredTopics) { // Now partiallyAnsweredTopics should be correctly set
                    analysisStatus = 'partially-answered';
                } else if (noTopicsAnsweredYet) {
                    analysisStatus = 'not-answered';
                } else {
                    analysisStatus = 'not-answered'; // Fallback
                }
                console.log(`  Analysis Status: ${analysisStatus}`); // Log final analysis status
                console.groupEnd(); // End console group

                if (analysisStatus !== 'answered') {
                    allAnalysesCompleted = false;
                }

                const totalQuestionsInAnalysis = Object.values(analysisData).flat().length;
                let answeredQuestionsCount = 0;
                for (const topicKey in analysisData) {
                    const topicAnswers = answers[analysisKey]?.[topicKey]?.answers || {};
                    answeredQuestionsCount += Object.keys(topicAnswers).length;
                }

                const topicCountInAnalysis = Object.keys(analysisData).length;

                const card = document.createElement('div');
                card.className = `checkpoint-card status-${analysisStatus}`;
                card.innerHTML = `
                    🎯 ${analysisKey}
                    <div class="card-details">
                        <p>🗂️ Topik: ${topicCountInAnalysis}</p>
                        <p>📝 Pertanyaan: ${totalQuestionsInAnalysis}</p>
                        <p>✅ Dijawab: ${answeredQuestionsCount}</p>
                        <p>❓ Belum Dijawab: ${totalQuestionsInAnalysis - answeredQuestionsCount}</p>
                    </div>
                `;
                card.addEventListener('click', function() {
                    displayTopicCheckpointPage(analysisKey);
                });
                cardsContainer.appendChild(card);
            }

            const seeReportBtn = document.getElementById('see-report-btn');
            if (allAnalysesCompleted && currentAnalysisKeys.length > 0) {
                seeReportBtn.style.display = 'block';
            } else {
                seeReportBtn.style.display = 'none';
            }
        }

        function displayTopicCheckpointPage(analysisKey) {
            checkpointSection.style.display = 'none';
            topicCheckpointSection.style.display = 'block';
            topicGreetingSection.style.display = 'none';
            questionSection.style.display = 'none';
            reportSection.style.display = 'none';

            topicCheckpointAnalysisNameDisplay.textContent = analysisKey;
            topicCheckpointCardsContainer.innerHTML = '';

            currentAnalysisIndex = currentAnalysisKeys.indexOf(analysisKey);
            currentTopicKeys = Object.keys(questionsData[analysisKey]);

            for (const topicKey of currentTopicKeys) {
                const topicData = questionsData[analysisKey][topicKey];
                const topicStatus = answers[analysisKey]?.[topicKey]?.status || "not-started"; // Get topic status
                let cardStatusClass = `status-not-answered`; // Default card status class

                if (topicStatus === 'completed') {
                    cardStatusClass = `status-answered`;
                } else if (topicStatus === 'in-progress') {
                    cardStatusClass = `status-partially-answered`;
                } else {
                    cardStatusClass = `status-not-answered`;
                }

                const totalQuestionsInTopic = topicData.length;
                let answeredQuestionsCount = 0;
                const topicAnswers = answers[analysisKey]?.[topicKey]?.answers || {};
                answeredQuestionsCount = Object.keys(topicAnswers).length;

                const card = document.createElement('div');
                card.className = `topic-checkpoint-card ${cardStatusClass}`;
                card.innerHTML = `
                    📂 ${topicKey}
                    <div class="card-details">
                        <p>📝 Pertanyaan: ${totalQuestionsInTopic}</p>
                        <p>✅ Dijawab: ${answeredQuestionsCount}</p>
                        <p>❓ Belum Dijawab: ${totalQuestionsInTopic - answeredQuestionsCount}</p>
                    </div>
                `;
                card.addEventListener('click', function() {
                    displayTopicGreetingPage(analysisKey, topicKey, topicStatus === 'completed'); // Pass isTopicCompleted flag based on topicStatus
                });
                topicCheckpointCardsContainer.appendChild(card);
            }
            goToMainCheckpointBtn_TopicCheckpoint.style.display = 'block';
        }


        function displayTopicGreetingPage(analysisKey, topicKey, isTopicCompleted = false) {
            checkpointSection.style.display = 'none';
            topicCheckpointSection.style.display = 'none';
            topicGreetingSection.style.display = 'block';
            questionSection.style.display = 'none';
            reportSection.style.display = 'none';

            const currentTopicKeysForAnalysis = Object.keys(questionsData[analysisKey]);
            const currentTopicIndexInAnalysis = currentTopicKeysForAnalysis.indexOf(topicKey);
            const isLastTopicInAnalysis = currentTopicIndexInAnalysis === currentTopicKeysForAnalysis.length - 1;
            const topicStatus = answers[analysisKey]?.[topicKey]?.status || "not-started";

            console.log(`displayTopicGreetingPage - Analysis: ${analysisKey}, Topic: ${topicKey}, Status: ${topicStatus}, isTopicCompleted: ${isTopicCompleted}`);

            if (isTopicCompleted) {
                console.log(`  isTopicCompleted is true, showing congratulatory message`);
                topicGreetingTitle.textContent = `Selamat! 🎉 Topik ${topicKey} Selesai!`;

                // --- Improved Next Uncompleted Topic Logic ---
                let nextUncompletedTopicKey = null;
                let nextUncompletedTopicIndex = -1;
                for (let i = 0; i < currentTopicKeysForAnalysis.length; i++) { // Iterate through ALL topics in analysis
                    const potentialNextTopicKey = currentTopicKeysForAnalysis[i];
                    const potentialNextTopicStatus = answers[analysisKey]?.[potentialNextTopicKey]?.status || "not-started";
                    if (potentialNextTopicStatus !== 'completed') {
                        nextUncompletedTopicKey = potentialNextTopicKey;
                        nextUncompletedTopicIndex = i;
                        break; // Found the FIRST uncompleted topic (in order of topic keys)
                    }
                }

                if (nextUncompletedTopicKey) { // If there IS an uncompleted topic
                    topicGreetingDescription.innerHTML = `Anda baru saja menyelesaikan pertanyaan survei untuk topik <span style="font-weight:bold;">${topicKey}</span> dari analisis <span style="font-weight:bold;">${analysisKey}</span>.<br><br>Siap untuk melanjutkan ke topik berikutnya, <span style="font-weight:bold;">${nextUncompletedTopicKey}</span>?`;
                    startTopicBtn.style.display = 'none';
                    nextTopicBtn.style.display = 'block';
                    nextTopicBtn.textContent = `Lanjut ke Topik ${nextUncompletedTopicKey} ➡️`;
                    nextTopicBtn.onclick = function() {
                        currentTopicIndex = nextUncompletedTopicIndex; // Set currentTopicIndex to the index of the next uncompleted topic
                        startAnalysisTopic(analysisKey, nextUncompletedTopicKey); // Start the next uncompleted topic
                    };
                } else { // If NO uncompleted topics left in this analysis
                    topicGreetingDescription.innerHTML = `Anda telah menyelesaikan semua topik untuk analisis <span style="font-weight:bold;">${analysisKey}</span>! 🎉`;
                    startTopicBtn.style.display = 'none';
                    nextTopicBtn.style.display = 'none';
                    displayAnalysisCompletionPage(analysisKey); // Call celebration page for analysis completion
                    return; // Exit function to prevent further navigation in THIS greeting page
                }
            } else { // Initial topic greeting (not completion)
                console.log(`  isTopicCompleted is false, showing initial greeting message`);
                topicGreetingTitle.textContent = `Analisis ${analysisKey} - Topik ${topicKey} 🚀`;
                topicGreetingDescription.innerHTML = `Anda akan menjawab pertanyaan survei untuk analisis <span style="font-weight:bold;">${analysisKey}</span>, topik <span style="font-weight:bold;">${topicKey}</span>. Klik tombol 'Mulai Survei Topik Ini' di bawah untuk memulai.`;
                startTopicBtn.style.display = 'block';
                startTopicBtn.textContent = `Mulai Survei Topik ${topicKey} 🚀`;
                startTopicBtn.onclick = function() { startAnalysisTopic(analysisKey, topicKey); };
                nextTopicBtn.style.display = 'none';
            }

            goToTopicCheckpointBtn_Greeting.style.display = 'block';
            goToMainCheckpointBtn_Greeting.style.display = 'block';
        }


        function startAnalysisTopic(analysisKey, topicKey) {
            checkpointSection.style.display = 'none';
            topicCheckpointSection.style.display = 'none';
            topicGreetingSection.style.display = 'none';
            questionSection.style.display = 'block';
            reportSection.style.display = 'none';

            currentAnalysisIndex = currentAnalysisKeys.indexOf(analysisKey);
            currentTopicKeys = Object.keys(questionsData[analysisKey]);
            currentTopicIndex = currentTopicKeys.indexOf(topicKey);
            currentQuestions = questionsData[analysisKey][topicKey];
            currentQuestionIndex = 0;

            displayQuestion();
        }

        function displayQuestion() {
            const analysisName = currentAnalysisKeys[currentAnalysisIndex];
            const topicName = currentTopicKeys[currentTopicIndex];
            let questionData = currentQuestions[currentQuestionIndex];

            // Check if it's a yes/no question and handle conditional display
            if (questionData.type === 'yesno') {
                displayYesNoQuestion(questionData); // Call function to display yes/no question
                return; // Exit to prevent default question display
            }

            // Display User Info in Question Card
            let userInfoHTML = `<p>🧑 <strong>${userData.fullName}</strong>, 🏢 <strong>${userData.companyName}</strong></p>`;
            userInfoHTML += `<p>💼 <strong>${userData.position}</strong>, 🏭 <strong>${userData.industry}</strong></p>`;
            userInfoHTML += `<p>📦 <strong>${userData.productService}</strong>, 📏 <strong>Ukuran: ${userData.companySize}</strong></p>`;
            document.getElementById('card-user-info-display').innerHTML = userInfoHTML;

            cardAnalysisTitle.textContent = `Analisis: ${analysisName} `;
            cardTopicTitle.textContent = `Topik: ${topicName} `;

            // --- Modified Question Display with Personalization and Line Breaks ---
            let personalizedQuestion = questionData.question.replace(/\${companyName}/g, userData.companyName);
            personalizedQuestion = personalizedQuestion.replace(/\${fullName}/g, userData.fullName);
            personalizedQuestion = personalizedQuestion.replace(/\${position}/g, userData.position);
            personalizedQuestion = personalizedQuestion.replace(/\${industry}/g, userData.industry);
            personalizedQuestion = personalizedQuestion.replace(/\${productService}/g, userData.productService);
            personalizedQuestion = personalizedQuestion.replace(/\${companySize}/g, userData.companySize);

            const words = personalizedQuestion.split(' ');
            let formattedQuestion = '';
            let line = '';
            words.forEach(word => {
                if ((line + word).split(' ').length > 7) {
                    formattedQuestion += line.trim() + '<br>';
                    line = word + ' ';
                } else {
                    line += word + ' ';
                }
            });
            formattedQuestion += line.trim(); // Add the last line
            cardQuestionText.innerHTML = formattedQuestion + ' 🤔';
            // --- End Modified Question Display ---

            answerTextarea.style.display = 'block'; // Ensure textarea is visible for regular questions
            answerTextarea.value = answers[questionData.answerKey] || '';
            confirmAnswerCheckbox.checked = answers[questionData.answerKey] ? true : false;
            updateProgress();
            updateButtonStates();
            answerTextarea.focus();

            questionCard.classList.add('hidden');
            setTimeout(() => {
                questionCard.classList.remove('hidden');
            }, 100);
        }
    
        function displayYesNoQuestion(questionData) {
            const analysisName = currentAnalysisKeys[currentAnalysisIndex];
            const topicName = currentTopicKeys[currentTopicIndex];
    
            // Display User Info in Question Card
            let userInfoHTML = `<p>🧑 <strong>${userData.fullName}</strong>, 🏢 <strong>${userData.companyName}</strong></p>`;
            userInfoHTML += `<p>💼 <strong>${userData.position}</strong>, 🏭 <strong>${userData.industry}</strong></p>`;
            userInfoHTML += `<p>📦 <strong>${userData.productService}</strong>, 📏 <strong>Ukuran: ${userData.companySize}</strong></p>`;
            document.getElementById('card-user-info-display').innerHTML = userInfoHTML;
    
            cardAnalysisTitle.textContent = `Analisis: ${analysisName} `;
            cardTopicTitle.textContent = `Topik: ${topicName} `;
    
            // --- Modified Question Display with Personalization and Line Breaks ---
            let personalizedQuestion = questionData.question.replace(/\${companyName}/g, userData.companyName);
            personalizedQuestion = personalizedQuestion.replace(/\${fullName}/g, userData.fullName);
            personalizedQuestion = personalizedQuestion.replace(/\${position}/g, userData.position);
            personalizedQuestion = personalizedQuestion.replace(/\${industry}/g, userData.industry);
            personalizedQuestion = personalizedQuestion.replace(/\${productService}/g, userData.productService);
            personalizedQuestion = personalizedQuestion.replace(/\${companySize}/g, userData.companySize);
    
            const words = personalizedQuestion.split(' ');
            let formattedQuestion = '';
            let line = '';
            words.forEach(word => {
                if ((line + word).split(' ').length > 7) {
                    formattedQuestion += line.trim() + '<br>';
                    line = word + ' ';
                } else {
                    line += word + ' ';
                }
            });
            formattedQuestion += line.trim(); // Add the last line
            cardQuestionText.innerHTML = formattedQuestion + ' 🤔';
            // --- End Modified Question Display ---
    
            answerTextarea.style.display = 'none'; // Hide textarea for yes/no questions
    
            // --- **ADD CHECKBOX HTML HERE** ---
            const answerConfirmationDiv = document.querySelector('.answer-confirmation.card-controls.combined-controls');
            answerConfirmationDiv.innerHTML = `
                <label>
                    <input type="checkbox" id="confirm-answer-checkbox"> Ya
                </label>
                <label style="margin-left: 20px;"> <input type="checkbox" id="reject-answer-checkbox"> Tidak </label>
            `;
            confirmAnswerCheckbox = document.getElementById('confirm-answer-checkbox'); // Re-assign global confirmAnswerCheckbox
            rejectAnswerCheckbox = document.getElementById('reject-answer-checkbox'); // Get reject checkbox
    
            // Set checkbox states based on saved answer
            if (answers[questionData.answerKey] === 'yes') {
                confirmAnswerCheckbox.checked = true;
                rejectAnswerCheckbox.checked = false;
            } else if (answers[questionData.answerKey] === 'no') {
                confirmAnswerCheckbox.checked = false;
                rejectAnswerCheckbox.checked = true;
            } else {
                confirmAnswerCheckbox.checked = false;
                rejectAnswerCheckbox.checked = false; // Default to unchecked if no answer
            }
    
    
            // --- END ADD CHECKBOX HTML ---
    
    
            updateProgress();
            updateButtonStates();
    
            questionCard.classList.add('hidden');
            setTimeout(() => {
                questionCard.classList.remove('hidden');
            }, 100);
    
            // --- Add Event Listeners for Checkboxes ---
            confirmAnswerCheckbox.addEventListener('change', function() {
                if (confirmAnswerCheckbox.checked) {
                    rejectAnswerCheckbox.checked = false; // Uncheck "No" if "Yes" is checked
                }
                updateButtonStates(); // Update button states based on checkbox changes
            });
    
            rejectAnswerCheckbox.addEventListener('change', function() {
                if (rejectAnswerCheckbox.checked) {
                    confirmAnswerCheckbox.checked = false; // Uncheck "Yes" if "No" is checked
                }
                updateButtonStates(); // Update button states based on checkbox changes
            });
            // --- End Event Listeners for Checkboxes ---
        }
    

        function updateProgress() {
            const totalQuestionsInTopic = currentQuestions.length;
            const currentQuestionNumber = currentQuestionIndex + 1;
            questionNumberDisplay.textContent = `Pertanyaan ${currentQuestionNumber} / ${totalQuestionsInTopic} 📊`;

            const answeredQuestionsInTopic = currentQuestions.reduce((count, q, index) => {
                return answers[q.answerKey] ? count + 1 : count;
            }, 0);
            const progressPercentage = (answeredQuestionsInTopic / totalQuestionsInTopic) * 100;
            progressBarFill.style.width = `${progressPercentage}%`;


            // Update progress bar segments
            progressBarSegments.innerHTML = '';
            for (let i = 0; i < totalQuestionsInTopic; i++) {
                const segment = document.createElement('div');
                segment.classList.add('progress-segment');
                if (!answers[currentQuestions[i].answerKey]) {
                    segment.classList.add('unanswered');
                }
                progressBarSegments.appendChild(segment);
            }
        }

        function updateButtonStates() {
            if (currentQuestions[currentQuestionIndex].type === 'yesno') {
                nextBtnQuestion.disabled = !(confirmAnswerCheckbox.checked || rejectAnswerCheckbox.checked); // Disable if neither checkbox is checked for yes/no
            } else {
                nextBtnQuestion.disabled = !confirmAnswerCheckbox.checked; // Original logic for other question types
            }
            prevBtn.disabled = currentQuestionIndex === 0 && currentTopicIndex === 0 && currentAnalysisIndex === 0; // Disable prev on very first question
        }

        function goToPreviousQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                 // --- Skip back over follow-up questions if the relevant "yesno" answer is "no" ---
                let prevQuestionData = currentQuestions[currentQuestionIndex];
                const nextQuestionData = currentQuestions[currentQuestionIndex + 1]; // Get the question we are moving back from
    
                 if (nextQuestionData && nextQuestionData.type === 'yesno' && answers[currentAnalysisKeys[currentAnalysisIndex]][currentTopicKeys[currentTopicIndex]].answers[nextQuestionData.answerKey] === 'no' && nextQuestionData.followUpQuestions && nextQuestionData.followUpQuestions.some(fq => fq.answerKey === prevQuestionData.answerKey)) {
                    // If next question was yesno, answer was no, and current question is a follow-up, skip back again
                    if (currentQuestionIndex > 0) {
                        currentQuestionIndex--; // Skip back again to the question before the follow-ups
                    } else {
                        // If already at the beginning of the topic after skipping back, do nothing more
                        displayQuestion(); // Just re-display current question
                        return;
                    }
                }
                 // --- End Skip Back Logic ---
                displayQuestion();
            } else if (currentTopicIndex > 0) {
                currentTopicIndex--;
                currentQuestions = questionsData[currentAnalysisKeys[currentAnalysisIndex]][currentTopicKeys[currentTopicIndex]];
                currentQuestionIndex = currentQuestions.length - 1;
                displayQuestion();
            } else if (currentAnalysisIndex > 0) {
                currentAnalysisIndex--;
                currentTopicKeys = Object.keys(questionsData[currentAnalysisKeys[currentAnalysisIndex]]);
                currentTopicIndex = currentTopicKeys.length - 1;
                currentQuestions = questionsData[currentAnalysisKeys[currentAnalysisIndex]][currentTopicKeys[currentTopicIndex]];
                currentQuestionIndex = currentQuestions.length - 1;
                displayQuestion();
            }
        }


        function goToNextQuestion() {
            const currentQuestion = currentQuestions[currentQuestionIndex]; // Get current question data
    
            let isYesNoQuestion = currentQuestion.type === 'yesno'; // Determine if it's a yes/no question
    
            if (isYesNoQuestion) {
                if (!confirmAnswerCheckbox.checked && !rejectAnswerCheckbox.checked) {
                    alert("Mohon pilih 'Ya' atau 'Tidak' sebelum melanjutkan.");
                    return;
                }
            } else { // Original validation for non-yesno questions
                if (!confirmAnswerCheckbox.checked) {
                    alert("Mohon centang 'Saya yakin dengan jawaban ini' sebelum melanjutkan.");
                    return;
                }
            }

            saveAnswer();
            const analysisName = currentAnalysisKeys[currentAnalysisIndex];
            const topicName = currentTopicKeys[currentTopicIndex];
            const currentTopicStatus = answers[analysisName]?.[topicName]?.status;
            console.log(`goToNextQuestion - After saveAnswer, Topic: ${topicName}, Status: ${currentTopicStatus}`);

            if (currentQuestionIndex < currentQuestions.length - 1) {
                currentQuestionIndex++;
                // --- Skip follow-up questions if the answer to the "yesno" question is "no" ---
                let nextQuestionData = currentQuestions[currentQuestionIndex];
                const previousQuestionData = currentQuestions[currentQuestionIndex - 1]; // Get the previous question
    
                if (previousQuestionData && previousQuestionData.type === 'yesno' && answers[analysisName][topicName].answers[previousQuestionData.answerKey] === 'no' && previousQuestionData.followUpQuestions && previousQuestionData.followUpQuestions.some(fq => fq.answerKey === nextQuestionData.answerKey)) {
                     // If previous question was yesno, answer was no, and current question is a follow-up, skip
                    if (currentQuestionIndex < currentQuestions.length - 1) {
                        currentQuestionIndex++; // Skip to the next question after follow-ups
                    } else {
                        displayTopicGreetingPage(analysisName, topicName, true); // If no more questions after follow-ups, end topic
                        return;
                    }
                }
                // --- End Skip Logic ---
                displayQuestion();
            } else { // Last question in topic
                displayTopicGreetingPage(analysisName, topicName, true); // Show greeting for CURRENT (completed) topic, indicate completion
            }
        }

        function displayAnalysisCompletionPage(analysisName) {
            questionSection.style.display = 'none';
            analysisCompletionSection.style.display = 'flex'; // Show celebration section
            document.getElementById('completed-analysis-name').textContent = analysisName; // Set analysis name in message

            createConfetti(300); // Generate confetti particles
            createBalloons(20);  // Generate balloon elements

            const goToCheckpointButton = document.getElementById('go-to-checkpoint-button');
            let timeoutId;

            goToCheckpointButton.onclick = function() {
                clearTimeout(timeoutId); // Clear timeout if button is clicked
                displayCheckpointPage();   // Go to main checkpoint immediately
            };

            timeoutId = setTimeout(function() {
                displayCheckpointPage();
            }, 10000); // 10000 milliseconds = 10 seconds
        }

        function createConfetti(count) {
            const container = document.querySelector('.confetti-container');
            container.innerHTML = ''; // Clear existing confetti

            for (let i = 0; i < count; i++) {
                const confetti = document.createElement('div');
                confetti.classList.add('confetti');
                confetti.style.left = `${Math.random() * 100}%`; // Random horizontal position
                confetti.style.animationDelay = `${Math.random() * 2}s`; // Random delay for staggered effect
                confetti.style.backgroundColor = getRandomConfettiColor(); // Random color
                container.appendChild(confetti);
            }
        }

        function createBalloons(count) {
            const container = document.querySelector('.balloon-container');
            container.innerHTML = ''; // Clear existing balloons

            for (let i = 0; i < count; i++) {
                const balloon = document.createElement('div');
                balloon.classList.add('balloon');
                balloon.style.left = `${Math.random() * 100}%`; // Random horizontal position
                balloon.style.animationDelay = `${Math.random() * 3}s`; // Random delay
                balloon.style.backgroundColor = getRandomBalloonColor(); // Random color
                container.appendChild(balloon);
            }
        }

        function getRandomConfettiColor() {
            const colors = ['#f09433', '#e74c3c', '#3498db', '#9b59b6', '#2ecc71']; // Example confetti colors
            return colors[Math.floor(Math.random() * colors.length)];
        }

        function getRandomBalloonColor() {
            const colors = ['#3498db', '#e74c3c', '#2ecc71', '#f39c12', '#9b59b6']; // Example balloon colors
            return colors[Math.floor(Math.random() * colors.length)];
        }

        function saveAnswer() {
            const analysisName = currentAnalysisKeys[currentAnalysisIndex];
            const topicName = currentTopicKeys[currentTopicIndex];
            const currentQuestion = currentQuestions[currentQuestionIndex];
            const answerKey = currentQuestion.answerKey;
            let answerValue;

            if (currentQuestion.type === 'yesno') {
                answerValue = confirmAnswerCheckbox.checked ? 'yes' : 'no'; // Save 'yes' or 'no' for yes/no questions
            } else {
                answerValue = answerTextarea.value; // Save textarea value for regular questions
            }

            // Initialize analysis and topic if they don't exist
            if (!answers[analysisName]) {
                answers[analysisName] = {};
            }
            if (!answers[analysisName][topicName]) {
                answers[analysisName][topicName] = {
                    status: "in-progress", // Set to "in-progress" when first answer is given
                    answers: {}
                };
            }

            // Save the answer
            answers[analysisName][topicName].answers[answerKey] = answerValue;
            answers[analysisName][topicName].status = "in-progress"; // Ensure status is at least in-progress

            // Check if all questions in the current topic are answered
            const allQuestionsAnsweredInTopic = currentQuestions.every(question => {
                return answers[analysisName][topicName].answers[question.answerKey] !== undefined && answers[analysisName][topicName].answers[question.answerKey] !== ""; // Check for not undefined and not empty string
            });

            if (allQuestionsAnsweredInTopic) {
                answers[analysisName][topicName].status = "completed";
            }

            saveAnswers(); // Save the updated answers object to localStorage
        }


        function showReport() {
            questionSection.style.display = 'none';
            reportSection.style.display = 'block';
            topicCheckpointSection.style.display = 'none'; // Hide topic checkpoint
            topicGreetingSection.style.display = 'none'; // Hide topic greeting
            checkpointSection.style.display = 'none'; // Hide main checkpoint

            // Display User Info in Report - UPDATED FORMATTING
            let userInfoHTML = '';
            userInfoHTML += `<div class="user-info-item"><strong>🧑 Nama Lengkap:</strong> ${userData.fullName}</div>`;
            userInfoHTML += `<div class="user-info-item"><strong>🏢 Nama Perusahaan:</strong> ${userData.companyName}</div>`;
            userInfoHTML += `<div class="user-info-item"><strong>💼 Jabatan:</strong> ${userData.position}</div>`;
            userInfoHTML += `<div class="user-info-item"><strong>🏭 Industri:</strong> ${userData.industry}</div>`;
            userInfoHTML += `<div class="user-info-item"><strong>📦 Produk/Jasa:</strong> ${userData.productService}</div>`;
            userInfoHTML += `<div class="user-info-item"><strong>📏 Ukuran Perusahaan:</strong> ${userData.companySize}</div>`;
            reportUserInfoDiv.innerHTML = userInfoHTML;

            // Display Answers in Report - No changes needed here
            let answersHTML = '';
            for (const analysisKey in questionsData) {
                answersHTML += `<h3>${analysisKey}</h3>`;
                for (const topicKey in questionsData[analysisKey]) {
                    answersHTML += `<h4>${topicKey}</h4>`;
                    questionsData[analysisKey][topicKey].forEach(qData => {
                        answersHTML += `<div class="answer-item"><div class="question-text">${qData.question}</div><div>${answers[qData.answerKey] || '<i>Tidak dijawab</i>'}</div></div>`;
                    });
                }
            }
            reportAnswersDiv.innerHTML = answersHTML;
        }

        const confirmAnswerCheckbox = document.getElementById('confirm-answer-checkbox');
        const nextBtnQuestion = document.getElementById('next-btn-question');

        // --- Event Listeners ---
        userInfoForm.addEventListener('submit', function(event) {
            event.preventDefault();
            userData = {
                fullName: document.getElementById('fullName').value,
                companyName: document.getElementById('companyName').value,
                position: document.getElementById('position').value,
                industry: document.getElementById('industry').value,
                productService: document.getElementById('productService').value,
                companySize: document.getElementById('companySize').value
            };
            startAnalysis();
        });


        nextBtnQuestion.addEventListener('click', goToNextQuestion);
        prevBtn.addEventListener('click', goToPreviousQuestion);

        confirmAnswerCheckbox.addEventListener('change', function() {
            updateButtonStates();
        });


        answerTextarea.addEventListener('input', function() {
            if (!confirmAnswerCheckbox.checked) {
                confirmAnswerCheckbox.checked = true;
                updateButtonStates();
            }
        });


        // --- Save User Data on Input Change ---
        document.querySelectorAll('.user-info-form input, .user-info-form select').forEach(input => {
            input.addEventListener('input', function() {
                userData = {
                    fullName: document.getElementById('fullName').value,
                    companyName: document.getElementById('companyName').value,
                    position: document.getElementById('position').value,
                    industry: document.getElementById('industry').value,
                    productService: document.getElementById('productService').value,
                    companySize: document.getElementById('companySize').value
                };
                saveUserData();
            });
        });

        const seeReportBtn = document.getElementById('see-report-btn');
        seeReportBtn.addEventListener('click', showReport);
        goToMainCheckpointBtn_TopicCheckpoint.addEventListener('click', displayCheckpointPage); // Back to main checkpoint from topic checkpoint
        goToTopicCheckpointBtn_Greeting.addEventListener('click', function() { displayTopicCheckpointPage(currentAnalysisKeys[currentAnalysisIndex]); }); // Go to topic checkpoint from greeting
        goToMainCheckpointBtn_Greeting.addEventListener('click', displayCheckpointPage); // Go to main checkpoint from greeting


        // --- Initialization ---
        currentTopicKeys = Object.keys(questionsData[currentAnalysisKeys[currentAnalysisIndex]]);
        currentQuestions = questionsData[currentAnalysisKeys[currentAnalysisIndex]][currentTopicKeys[currentTopicIndex]];

        loadUserData();
        loadAnswers();
        if (Object.values(userData).some(value => value)) {
            userInfoFormSection.style.display = 'none';
            displayCheckpointPage(); // Show checkpoint page on initialization if user data exists
        } else {
            userInfoFormSection.style.display = 'block';
            checkpointSection.style.display = 'none';
            topicCheckpointSection.style.display = 'none'; // Hide topic checkpoint on init
            topicGreetingSection.style.display = 'none'; // Hide topic greeting on init
            questionSection.style.display = 'none';
            reportSection.style.display = 'none';
        }

        // --- Keyboard Shortcut for Next Question (Ctrl + Enter) ---
        document.addEventListener('keydown', function(event) {
            if (event.ctrlKey && event.key === 'Enter') {
                if (!nextBtnQuestion.disabled) { // Check if the button is not disabled
                    event.preventDefault(); // Prevent default form submission behavior (if any)
                    nextBtnQuestion.click(); // Programmatically click the "Next Question" button
                }
            }
        });
    </script>
</body>
</html>